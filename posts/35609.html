<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>随便写的一些东西 | 洛屿的小站</title><meta name="author" content="drluo"><meta name="copyright" content="drluo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="爱来自ZZULI❤drluo   C&#x2F;C++ 图像经过bitset处理为二进制后再转为uchar格式便于串口发送，并支持解码为uchar数组（240 * 320）(row * col) 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575">
<meta property="og:type" content="article">
<meta property="og:title" content="随便写的一些东西">
<meta property="og:url" content="https://luoy-oss.github.io/posts/35609">
<meta property="og:site_name" content="洛屿的小站">
<meta property="og:description" content="爱来自ZZULI❤drluo   C&#x2F;C++ 图像经过bitset处理为二进制后再转为uchar格式便于串口发送，并支持解码为uchar数组（240 * 320）(row * col) 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://luoy-oss.github.io/img/cover/luoy.jpg">
<meta property="article:published_time" content="2024-01-05T06:45:45.000Z">
<meta property="article:modified_time" content="2024-02-28T13:17:17.422Z">
<meta property="article:author" content="drluo">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="C语言">
<meta property="article:tag" content="C++">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="HTML">
<meta property="article:tag" content="JavaScript">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://luoy-oss.github.io/img/cover/luoy.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://luoy-oss.github.io/posts/35609"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7f5ed61079146933544dc4627400aaf0";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"好像没有关于 “${query}” 的内容呢"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功！',
    error: '复制错误❌',
    noSupport: '浏览器好像不支持复制呢，换一个浏览器试试吧'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: drluo","link":"链接: ","source":"来源: 洛屿的小站","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: '/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: '/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '随便写的一些东西',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-02-28 21时17分17秒 21:17:17'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/self/user.css"><link rel="stylesheet" href="/self/androidstudio.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><link rel="stylesheet" href="/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="/npm/pace-js/pace.min.js"></script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cravatar.cn/avatar/6fa57e21db3ba5961f18a8ae75d0a081" onerror="onerror=null;src='/img/err_img404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">65</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">45</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/message/"><i class="fa-fw fas fa-comment"></i><span> 留言板</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/cover/luoy.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="洛屿的小站"><img class="site-icon" src="/img/drluoLogo.png"/></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/message/"><i class="fa-fw fas fa-comment"></i><span> 留言板</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">随便写的一些东西</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-01-05T06:45:45.000Z" title="发表于 2024-01-05 14时45分45秒 14:45:45">2024-01-05 14时45分45秒</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-02-28T13:17:17.422Z" title="更新于 2024-02-28 21时17分17秒 21:17:17">2024-02-28 21时17分17秒</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%88%91/">我</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">预计阅读时长:</span><span>30分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>爱来自ZZULI❤<a href="https://luoy-oss.github.io">drluo</a></p>
</blockquote>
<p><img src="/img/page/ZZULI.webp" alt=""></p>
<h1>C/C++</h1>
<h2 id="图像经过bitset处理为二进制后再转为uchar格式便于串口发送，并支持解码为uchar数组（240-320）-row-col">图像经过bitset处理为二进制后再转为uchar格式便于串口发送，并支持解码为uchar数组（240 * 320）(row * col)</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs c++"> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UCHARFrame</span> &#123;<br><span class="hljs-keyword">public</span>:<br>	<span class="hljs-built_in">UCHARFrame</span>() &#123;<br><br>	&#125;<br>	<span class="hljs-built_in">UCHARFrame</span>(<span class="hljs-type">const</span> cv::Mat bi_frame) &#123;<br>		<span class="hljs-built_in">biFrameToUCHARarr</span>(bi_frame);<br>		<span class="hljs-keyword">this</span>-&gt;uframe = (uchar*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(uchar) * <span class="hljs-number">320</span> * <span class="hljs-number">240</span>);<br>	&#125;<br><br>	~<span class="hljs-built_in">UCHARFrame</span>() &#123;<br>		<span class="hljs-built_in">free</span>(<span class="hljs-keyword">this</span>-&gt;uframe);<br>	&#125;<br>	<span class="hljs-comment">// 320列 240行图像 二进制转换为uchar array</span><br>	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">biFrameToUCHARarr</span><span class="hljs-params">(<span class="hljs-type">const</span> cv::Mat bi_frame)</span> </span>&#123;<br>		std::bitset&lt;8&gt; f[<span class="hljs-number">240</span>][<span class="hljs-number">40</span>];<br>		<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> r = <span class="hljs-number">0</span>; r &lt; <span class="hljs-number">240</span>; r++) &#123;<br>			<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> c = <span class="hljs-number">0</span>; c &lt; <span class="hljs-number">320</span>; c++) &#123;<br>				<span class="hljs-type">int</span> data = *(bi_frame.data + c + r * <span class="hljs-number">320</span>);<br>				<span class="hljs-keyword">if</span> (data == <span class="hljs-number">0</span>) &#123;<br>					f[r][c / <span class="hljs-number">8</span>].<span class="hljs-built_in">reset</span>(c % <span class="hljs-number">8</span>);<br>				&#125;<br>				<span class="hljs-comment">//白色 置为1</span><br>				<span class="hljs-keyword">else</span> &#123;<br>					f[r][c / <span class="hljs-number">8</span>].<span class="hljs-built_in">set</span>(c % <span class="hljs-number">8</span>);<br>				&#125;<br>			&#125;<br>		&#125;<br><br>		<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> r = <span class="hljs-number">0</span>; r &lt; <span class="hljs-number">240</span>; r++) &#123;<br>			<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">40</span>; i++) &#123;<br>				<span class="hljs-keyword">this</span>-&gt;frame_uchar_data[r][i] = f[r][i].<span class="hljs-built_in">to_ulong</span>();<br>			&#125;<br>		&#125;<br>	&#125;<br><br>	<span class="hljs-comment">// 320列 240行图像 二进制转换为uchar array</span><br>	<span class="hljs-function">uchar* <span class="hljs-title">ucharArrToBiFrame</span><span class="hljs-params">()</span> </span>&#123;<br>		<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> r = <span class="hljs-number">0</span>; r &lt; <span class="hljs-number">240</span>; r++) &#123;<br>			<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">40</span>; i++) &#123;<br>				<span class="hljs-type">int</span> index = i * <span class="hljs-number">8</span>;<br>				<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> b = <span class="hljs-number">1</span>; b &lt; (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">8</span>); b = b &lt;&lt; <span class="hljs-number">1</span>) &#123;<br>					<span class="hljs-comment">// 当前二进制位为1 白色</span><br>					<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>-&gt;frame_uchar_data[r][i] &amp; b) &#123;<br>						*(<span class="hljs-keyword">this</span>-&gt;uframe + r * <span class="hljs-number">320</span> + index) = <span class="hljs-number">255</span>;<br>					&#125;<br>					<span class="hljs-keyword">else</span> &#123;<br>						*(<span class="hljs-keyword">this</span>-&gt;uframe + r * <span class="hljs-number">320</span> + index) = <span class="hljs-number">0</span>;<br>					&#125;<br>					index++;<br>				&#125;<br>			&#125;<br>		&#125;<br>		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>-&gt;uframe;<br>	&#125;<br><br><br><span class="hljs-keyword">private</span>:<br>	uchar frame_uchar_data[<span class="hljs-number">240</span>][<span class="hljs-number">40</span>];<br>	uchar* uframe;<br>&#125;;<br><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>	VideoCapture cap;<br>	cap.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;../video/result_best.mp4&quot;</span>);<br>	cap.<span class="hljs-built_in">set</span>(CAP_PROP_FRAME_WIDTH, <span class="hljs-number">320</span>);    <span class="hljs-comment">//设置宽度</span><br>	cap.<span class="hljs-built_in">set</span>(CAP_PROP_FRAME_HEIGHT, <span class="hljs-number">240</span>);  <span class="hljs-comment">//设置长度</span><br>	cap.<span class="hljs-built_in">set</span>(CAP_PROP_FOURCC, VideoWriter::<span class="hljs-built_in">fourcc</span>(<span class="hljs-string">&#x27;M&#x27;</span>, <span class="hljs-string">&#x27;J&#x27;</span>, <span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;G&#x27;</span>));<span class="hljs-comment">//视频流格式</span><br>	Mat frame;<br>	<span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>		cap &gt;&gt; frame;<br>		<span class="hljs-built_in">cvtColor</span>(frame, frame, COLOR_BGR2GRAY);<br>		<span class="hljs-built_in">threshold</span>(frame, frame, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>, THRESH_OTSU);	<br>		<span class="hljs-function">UCHARFrame <span class="hljs-title">uFrame</span><span class="hljs-params">(frame)</span></span>;<br>		uchar* uframe = uFrame.<span class="hljs-built_in">ucharArrToBiFrame</span>();<br><br>		<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> r = <span class="hljs-number">0</span>; r &lt; <span class="hljs-number">240</span>; r++) &#123;<br>			<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> c = <span class="hljs-number">0</span>; c &lt; <span class="hljs-number">320</span>; c++) &#123;<br>				<span class="hljs-comment">// 黑色点</span><br>				<span class="hljs-keyword">if</span> ((<span class="hljs-type">int</span>)(uframe + r * <span class="hljs-number">240</span> + c) == <span class="hljs-number">0</span>) &#123;<br>					cout &lt;&lt; <span class="hljs-number">0</span>;<br>				&#125;<br>				<span class="hljs-comment">// 白色点</span><br>				<span class="hljs-keyword">else</span> &#123;<br>					cout &lt;&lt; <span class="hljs-number">1</span>;<br>				&#125;<br>			&#125;<br>			cout &lt;&lt; endl;<br>		&#125;<br><br>		<span class="hljs-built_in">waitKey</span>(<span class="hljs-number">100000</span>);<br>	&#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="拼音排序">拼音排序</h2>
<p><a target="_blank" rel="noopener" href="https://drluo.lanzoul.com/iufHi1khjv5e">unicode_to_hanyu_pinyin.txt下载地址</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c++">std::map&lt;<span class="hljs-type">int</span>, std::string&gt; pinyinMap;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">readPinYinData</span><span class="hljs-params">()</span> </span>&#123;<br>    FILE* fin;<br>    <span class="hljs-built_in">fopen_s</span>(&amp;fin, <span class="hljs-string">&quot;unicode_to_hanyu_pinyin.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>);<br><br>    <span class="hljs-keyword">if</span> (fin == <span class="hljs-literal">NULL</span>) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;拼音文件打开失败！\n汉语排序可能出错！&quot;</span>);<br>        <span class="hljs-built_in">MessageBox</span>(<span class="hljs-literal">NULL</span>, _T(<span class="hljs-string">&quot;拼音文件打开失败！\n汉语排序可能出错！&quot;</span>), _T(<span class="hljs-string">&quot;&quot;</span>), MB_OK | MB_SYSTEMMODAL);<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-type">int</span> hexNum;<br>        <span class="hljs-type">char</span>* pinyinStr = <span class="hljs-keyword">new</span> <span class="hljs-type">char</span>[<span class="hljs-number">100</span>];<br>        <span class="hljs-keyword">while</span> (!<span class="hljs-built_in">feof</span>(fin)) &#123;<br>            <span class="hljs-built_in">fscanf_s</span>(fin, <span class="hljs-string">&quot;%x,%s&quot;</span>, &amp;hexNum, pinyinStr, <span class="hljs-number">10</span>);<br>            <span class="hljs-built_in">getc</span>(fin);<br>            <span class="hljs-comment">//printf(&quot;%x %s\n&quot;, hexNum, pinyinStr);</span><br>            pinyinMap.<span class="hljs-built_in">insert</span>(std::pair&lt;<span class="hljs-type">int</span>, std::string&gt;&#123;hexNum, pinyinStr&#125;);         <br>        &#125;<br><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;成功载入拼音数据：%zd份&quot;</span>, pinyinMap.<span class="hljs-built_in">size</span>());<br>        <span class="hljs-built_in">fclose</span>(fin);<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">compare</span><span class="hljs-params">(<span class="hljs-type">const</span> std::wstring&amp; a, <span class="hljs-type">const</span> std::wstring&amp; b)</span> </span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; a.<span class="hljs-built_in">size</span>() &amp;&amp; i &lt; b.<span class="hljs-built_in">size</span>(); ++i) &#123;<br>        <span class="hljs-keyword">if</span> (a[i] != b[i]) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">strcmp</span>(pinyinMap[(<span class="hljs-type">int</span>)a[i]].<span class="hljs-built_in">c_str</span>(), pinyinMap[(<span class="hljs-type">int</span>)b[i]].<span class="hljs-built_in">c_str</span>()) &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> a.<span class="hljs-built_in">size</span>() &lt; b.<span class="hljs-built_in">size</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">cmpWithName</span><span class="hljs-params">(Drug a, Drug b)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">compare</span>(a.name, b.name);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">sortByName</span><span class="hljs-params">(std::vector&lt;Drug&gt;&amp; drugList)</span> </span>&#123;<br>	std::<span class="hljs-built_in">sort</span>(drugList.<span class="hljs-built_in">begin</span>(), drugList.<span class="hljs-built_in">end</span>(), cmpWithName);<br>&#125;<br><br></code></pre></td></tr></table></figure>
<h1>Python</h1>
<h2 id="mp42img">mp42img</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 导入所需要的库</span><br><span class="hljs-keyword">import</span> cv2<br><br><span class="hljs-comment"># 定义保存图片函数</span><br><span class="hljs-comment"># image:要保存的图片名字</span><br><span class="hljs-comment"># addr；图片地址与相片名字的前部分</span><br><span class="hljs-comment"># num: 相片，名字的后缀。int 类型x</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">save_image</span>(<span class="hljs-params">image,addr,num</span>):<br>    address = addr + <span class="hljs-built_in">str</span>(num)+ <span class="hljs-string">&#x27;.jpg&#x27;</span><br>    cv2.imwrite(address,image)<br><br><span class="hljs-comment"># 读取视频文件</span><br>videoCapture = cv2.VideoCapture(<span class="hljs-string">&quot;sample.mp4&quot;</span>)<br><span class="hljs-comment"># 通过摄像头的方式</span><br><span class="hljs-comment"># videoCapture=cv2.VideoCapture(1)</span><br><br><span class="hljs-comment">#读帧</span><br>success, frame = videoCapture.read()<br>i = <span class="hljs-number">1000</span><br>timeF = <span class="hljs-number">3</span><br>j=<span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> success :<br>    i = i + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> (i % timeF == <span class="hljs-number">0</span>):<br>        j = j + <span class="hljs-number">1</span><br>        save_image(frame,<span class="hljs-string">&#x27;./frame/&#x27;</span>,j)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;save image:&#x27;</span>,i)<br>    success, frame = videoCapture.read()<br></code></pre></td></tr></table></figure>
<h2 id="img2mp4">img2mp4</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2<br><br>fourcc = cv2.VideoWriter_fourcc(<span class="hljs-string">&#x27;m&#x27;</span>, <span class="hljs-string">&#x27;p&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&#x27;v&#x27;</span>)  <span class="hljs-comment"># 设置输出视频为mp4格式</span><br><br><span class="hljs-comment"># cap_fps是帧率，可以根据随意设置</span><br>cap_fps = <span class="hljs-number">30</span><br><br><span class="hljs-comment"># 注意！！！</span><br><span class="hljs-comment"># size要和图片的size一样，但是通过img.shape得到图像的参数是（height，width，channel），但是此处的size要传的是（width，height），这里一定要注意注意不然结果会打不开，比如通过img.shape得到常用的图片尺寸</span><br>size = (<span class="hljs-number">320</span>, <span class="hljs-number">240</span>)<br><br><span class="hljs-comment"># 设置输出视频的参数，如果是灰度图，可以加上 isColor = 0 这个参数</span><br><span class="hljs-comment"># video = cv2.VideoWriter(&#x27;results/result.avi&#x27;,fourcc, cap_fps, size, isColor=0)</span><br>video = cv2.VideoWriter(<span class="hljs-string">&#x27;result_best.mp4&#x27;</span>, fourcc, cap_fps, size)<br><br><span class="hljs-comment"># 这里直接读取py文件所在目录下的pics目录所有图片。</span><br>path = <span class="hljs-string">&#x27;./image/bestf/&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1000</span>):<br>    filename = <span class="hljs-built_in">str</span>(i) + <span class="hljs-string">&quot;.jpg&quot;</span><br>    img = cv2.imread(path + filename)<br>    video.write(img)<br></code></pre></td></tr></table></figure>
<h2 id="视频加速">视频加速</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2<br><br>vdop = <span class="hljs-string">&quot;.\\lx2.mp4&quot;</span><span class="hljs-comment">#输入视频路径</span><br>cap = cv2.VideoCapture(vdop)<br>fps = cap.get(cv2.CAP_PROP_FPS) <span class="hljs-comment">#获取输入视频的帧率</span><br>size = (<span class="hljs-built_in">int</span>(cap.get(cv2.CAP_PROP_FRAME_WIDTH)),<br>        <span class="hljs-built_in">int</span>(cap.get(cv2.CAP_PROP_FRAME_HEIGHT)))<span class="hljs-comment">#获取输入视频的大小</span><br>fourcc =  cv2.VideoWriter_fourcc(<span class="hljs-string">&#x27;m&#x27;</span>, <span class="hljs-string">&#x27;p&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&#x27;v&#x27;</span>)  <span class="hljs-comment"># 设置输出视频为mp4格式</span><br><br>out_path = <span class="hljs-string">&quot;.\\fast.mp4&quot;</span> <span class="hljs-comment">#输出2倍速的avi格式的视频路径</span><br>output_viedo = cv2.VideoWriter()<br>fps = <span class="hljs-number">2</span>*fps <span class="hljs-comment">#2倍速处理</span><br><span class="hljs-comment">#isColor：如果该位值为Ture，解码器会进行颜色框架的解码，否则会使用灰度进行颜色架构</span><br>output_viedo.<span class="hljs-built_in">open</span>(out_path , fourcc, fps, size, isColor=<span class="hljs-literal">True</span>)<br>rval = <span class="hljs-literal">True</span><br><span class="hljs-keyword">while</span> rval:<br>    rval, img = cap.read()<span class="hljs-comment">#逐帧读取原视频</span><br>    output_viedo.write(img)<span class="hljs-comment">#写入视频帧</span><br>output_viedo.release()<br>cap.release()<br></code></pre></td></tr></table></figure>
<h2 id="图像RGB均值-方差计算">图像RGB均值/方差计算</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> cv2<br><br>files_dir = <span class="hljs-string">&#x27;./Images/&#x27;</span><br>files = os.listdir(files_dir)<br><br>R = <span class="hljs-number">0.</span><br>G = <span class="hljs-number">0.</span><br>B = <span class="hljs-number">0.</span><br>R_2 = <span class="hljs-number">0.</span><br>G_2 = <span class="hljs-number">0.</span><br>B_2 = <span class="hljs-number">0.</span><br>N = <span class="hljs-number">0</span><br><br><br><span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> files:<br>    img = cv2.imread(files_dir+file)<br>    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)<br>    img = np.array(img)<br>    h, w, c = img.shape<br>    N += h*w<br><br>    R_t = img[:, :, <span class="hljs-number">0</span>]<br>    R += np.<span class="hljs-built_in">sum</span>(R_t)<br>    R_2 += np.<span class="hljs-built_in">sum</span>(np.power(R_t, <span class="hljs-number">2.0</span>))<br><br>    G_t = img[:, :, <span class="hljs-number">1</span>]<br>    G += np.<span class="hljs-built_in">sum</span>(G_t)<br>    G_2 += np.<span class="hljs-built_in">sum</span>(np.power(G_t, <span class="hljs-number">2.0</span>))<br><br>    B_t = img[:, :, <span class="hljs-number">2</span>]<br>    B += np.<span class="hljs-built_in">sum</span>(B_t)<br>    B_2 += np.<span class="hljs-built_in">sum</span>(np.power(B_t, <span class="hljs-number">2.0</span>))<br><br>R_mean = R/N<br>G_mean = G/N<br>B_mean = B/N<br><br>R_std = np.sqrt(R_2/N - R_mean*R_mean)<br>G_std = np.sqrt(G_2/N - G_mean*G_mean)<br>B_std = np.sqrt(B_2/N - B_mean*B_mean)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;R_mean: %f, G_mean: %f, B_mean: %f&quot;</span> % (R_mean, G_mean, B_mean))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;R_std: %f, G_std: %f, B_std: %f&quot;</span> % (R_std, G_std, B_std))<br></code></pre></td></tr></table></figure>
<h2 id="VOC数据集列表获取">VOC数据集列表获取</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_annotations</span>(<span class="hljs-params">label_list, datadir, Annotations = <span class="hljs-string">&#x27;annotations&#x27;</span>, Images = <span class="hljs-string">&#x27;images&#x27;</span></span>):<br>    filenames = os.listdir(os.path.join(datadir, Annotations))<br>    records = []<br>    ct = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> fname <span class="hljs-keyword">in</span> filenames:<br>        fid = fname.split(<span class="hljs-string">&#x27;.&#x27;</span>)[<span class="hljs-number">0</span>]<br>        fpath = os.path.join(datadir, Annotations, fname)<br>        img_file = os.path.join(datadir, Images, fid + <span class="hljs-string">&#x27;.jpg&#x27;</span>)<br>        tree = ET.parse(fpath)<br><br>        <span class="hljs-keyword">if</span> tree.find(<span class="hljs-string">&#x27;id&#x27;</span>) <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            im_id = np.array([ct])<br>        <span class="hljs-keyword">else</span>:<br>            im_id = np.array([<span class="hljs-built_in">int</span>(tree.find(<span class="hljs-string">&#x27;id&#x27;</span>).text)])<br><br>        objs = tree.findall(<span class="hljs-string">&#x27;object&#x27;</span>)<br>        im_w = <span class="hljs-built_in">float</span>(tree.find(<span class="hljs-string">&#x27;size&#x27;</span>).find(<span class="hljs-string">&#x27;width&#x27;</span>).text)<br>        im_h = <span class="hljs-built_in">float</span>(tree.find(<span class="hljs-string">&#x27;size&#x27;</span>).find(<span class="hljs-string">&#x27;height&#x27;</span>).text)<br>        gt_bbox = np.zeros((<span class="hljs-built_in">len</span>(objs), <span class="hljs-number">4</span>), dtype=np.float32)<br>        gt_class = np.zeros((<span class="hljs-built_in">len</span>(objs), ), dtype=np.int32)<br>        is_crowd = np.zeros((<span class="hljs-built_in">len</span>(objs), ), dtype=np.int32)<br>        difficult = np.zeros((<span class="hljs-built_in">len</span>(objs), ), dtype=np.int32)<br>        <span class="hljs-keyword">for</span> i, obj <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(objs):<br>            cname = obj.find(<span class="hljs-string">&#x27;name&#x27;</span>).text<br>            gt_class[i] = label_list[cname]<br>            _difficult = <span class="hljs-built_in">int</span>(obj.find(<span class="hljs-string">&#x27;difficult&#x27;</span>).text)<br>            x1 = <span class="hljs-built_in">float</span>(obj.find(<span class="hljs-string">&#x27;bndbox&#x27;</span>).find(<span class="hljs-string">&#x27;xmin&#x27;</span>).text)<br>            y1 = <span class="hljs-built_in">float</span>(obj.find(<span class="hljs-string">&#x27;bndbox&#x27;</span>).find(<span class="hljs-string">&#x27;ymin&#x27;</span>).text)<br>            x2 = <span class="hljs-built_in">float</span>(obj.find(<span class="hljs-string">&#x27;bndbox&#x27;</span>).find(<span class="hljs-string">&#x27;xmax&#x27;</span>).text)<br>            y2 = <span class="hljs-built_in">float</span>(obj.find(<span class="hljs-string">&#x27;bndbox&#x27;</span>).find(<span class="hljs-string">&#x27;ymax&#x27;</span>).text)<br>            x1 = <span class="hljs-built_in">max</span>(<span class="hljs-number">0</span>, x1)<br>            y1 = <span class="hljs-built_in">max</span>(<span class="hljs-number">0</span>, y1)<br>            x2 = <span class="hljs-built_in">min</span>(im_w - <span class="hljs-number">1</span>, x2)<br>            y2 = <span class="hljs-built_in">min</span>(im_h - <span class="hljs-number">1</span>, y2)<br>            <span class="hljs-comment"># 这里使用xywh格式来表示目标物体真实框</span><br>            gt_bbox[i] = [(x1+x2)/<span class="hljs-number">2.0</span> , (y1+y2)/<span class="hljs-number">2.0</span>, x2-x1+<span class="hljs-number">1.</span>, y2-y1+<span class="hljs-number">1.</span>]<br>            is_crowd[i] = <span class="hljs-number">0</span><br>            difficult[i] = _difficult<br><br>        voc_rec = &#123;<br>            <span class="hljs-string">&#x27;im_file&#x27;</span>: img_file,<br>            <span class="hljs-string">&#x27;im_id&#x27;</span>: im_id,<br>            <span class="hljs-string">&#x27;h&#x27;</span>: im_h,<br>            <span class="hljs-string">&#x27;w&#x27;</span>: im_w,<br>            <span class="hljs-string">&#x27;is_crowd&#x27;</span>: is_crowd,<br>            <span class="hljs-string">&#x27;gt_class&#x27;</span>: gt_class,<br>            <span class="hljs-string">&#x27;gt_bbox&#x27;</span>: gt_bbox,<br>            <span class="hljs-string">&#x27;gt_poly&#x27;</span>: [],<br>            <span class="hljs-string">&#x27;difficult&#x27;</span>: difficult<br>            &#125;<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(objs) != <span class="hljs-number">0</span>:<br>            records.append(voc_rec)<br>        ct += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> records<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">record格式：</span><br><span class="hljs-string">&#123;&#x27;im_file&#x27;: &#x27;Car2024\\Images\\block1.jpg&#x27;, &#x27;im_id&#x27;: array([0]), &#x27;h&#x27;: 240.0, &#x27;w&#x27;: 320.0, &#x27;is_crowd&#x27;: array([0, 0, 0]), &#x27;gt_class&#x27;: array([11,  8,  8]), &#x27;gt_bbox&#x27;: array([[110.5,  21.5,  36. ,  30. ],</span><br><span class="hljs-string">       [ 99.5,  70. ,  32. ,  41. ],</span><br><span class="hljs-string">       [266. , 164.5,  49. ,  70. ]], dtype=float32), &#x27;gt_poly&#x27;: [], &#x27;difficult&#x27;: array([0, 0, 0])&#125;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><br><span class="hljs-comment"># E.g</span><br>label_list = &#123;<span class="hljs-string">&#x27;spy&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;safety&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;bridge&#x27;</span>: <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;danger&#x27;</span>: <span class="hljs-number">3</span>, <span class="hljs-string">&#x27;tumble&#x27;</span>: <span class="hljs-number">4</span>, <span class="hljs-string">&#x27;thief&#x27;</span>: <span class="hljs-number">5</span>, <span class="hljs-string">&#x27;evil&#x27;</span>: <span class="hljs-number">6</span>, <span class="hljs-string">&#x27;bomb&#x27;</span>: <span class="hljs-number">7</span>, <span class="hljs-string">&#x27;cone&#x27;</span>: <span class="hljs-number">8</span>, <span class="hljs-string">&#x27;crosswalk&#x27;</span>: <span class="hljs-number">9</span>, <span class="hljs-string">&#x27;prop&#x27;</span>: <span class="hljs-number">10</span>, <span class="hljs-string">&#x27;block&#x27;</span>: <span class="hljs-number">11</span>, <span class="hljs-string">&#x27;patient&#x27;</span>: <span class="hljs-number">12</span>&#125;<br>records = get_annotations(label_list, train_dir, Annotations = <span class="hljs-string">&#x27;Annotations&#x27;</span>, Images = <span class="hljs-string">&#x27;Images&#x27;</span>)<br><br></code></pre></td></tr></table></figure>
<h2 id="VOC数据类别统计">VOC数据类别统计</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">#数据集预处理.类别统计</span><br><span class="hljs-string"># !/usr/bin/env python</span><br><span class="hljs-string"># encoding: utf-8</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">import</span> xml.dom.minidom <span class="hljs-keyword">as</span> xmldom<br><span class="hljs-keyword">import</span> os<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">voc_label_statistics</span>(<span class="hljs-params">annotation_path</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    VOC 数据集类别统计</span><br><span class="hljs-string">    :param annotation_path: voc数据集的标签文件夹</span><br><span class="hljs-string">    :return: &#123;&#x27;class1&#x27;:&#x27;count&#x27;,...&#125;</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    count = <span class="hljs-number">0</span><br>    annotation_names = [<br>        os.path.join(annotation_path, i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> os.listdir(annotation_path)<br>    ]<br><br>    labels = <span class="hljs-built_in">dict</span>()<br>    <span class="hljs-keyword">for</span> names <span class="hljs-keyword">in</span> annotation_names:<br>        names_arr = names.split(<span class="hljs-string">&quot;.&quot;</span>)<br>        file_type = names_arr[-<span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">if</span> file_type != <span class="hljs-string">&quot;xml&quot;</span>:<br>            <span class="hljs-keyword">continue</span><br>        file_size = os.path.getsize(names)<br>        <span class="hljs-keyword">if</span> file_size == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br><br>        count = count + <span class="hljs-number">1</span><br>        <span class="hljs-comment"># print(&#x27;process：&#x27;, names)</span><br>        xmlfilepath = names<br>        domobj = xmldom.parse(xmlfilepath)<br>        <span class="hljs-comment"># 得到元素对象</span><br>        elementobj = domobj.documentElement<br>        <span class="hljs-comment"># 获得子标签</span><br>        subElementObj = elementobj.getElementsByTagName(<span class="hljs-string">&quot;object&quot;</span>)<br>        <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> subElementObj:<br>            label = s.getElementsByTagName(<span class="hljs-string">&quot;name&quot;</span>)[<span class="hljs-number">0</span>].firstChild.data<br><br>            label_count = labels.get(label, <span class="hljs-number">0</span>)<br>            labels[label] = label_count + <span class="hljs-number">1</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;文件标注个数：&quot;</span>, count)<br>    <span class="hljs-keyword">return</span> labels<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    annotation_path = <span class="hljs-string">&quot;C:/Users/drluo/Desktop/total train data/Annotations&quot;</span><br><br>    label = voc_label_statistics(annotation_path)<br>    <span class="hljs-built_in">print</span>(label)<br></code></pre></td></tr></table></figure>
<h2 id="VOC数据分配">VOC数据分配</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    这是随机划分VOC数据集的脚本</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">random_split_voc_dataset</span>(<span class="hljs-params">voc_dataset_dir, train_ratio=<span class="hljs-number">0.8</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    这是随机划分VOC数据集为训练集和验证集的函数</span><br><span class="hljs-string">    :param voc_dataset_dir: VOC数据集地址</span><br><span class="hljs-string">    :param train_ratio: 训练集比例，默认为0.8</span><br><span class="hljs-string">    :return:</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment"># 初始化相关文件和文件夹路径</span><br>    <span class="hljs-comment"># voc_main_dir = os.path.join(voc_dataset_dir,&#x27;ImageSets&#x27;,&#x27;Main&#x27;)</span><br>    voc_main_dir = voc_dataset_dir<br>    voc_image_dir = os.path.join(voc_dataset_dir, <span class="hljs-string">&#x27;Images&#x27;</span>)<br>    train_txt_path = os.path.join(voc_main_dir, <span class="hljs-string">&#x27;train.txt&#x27;</span>)<br>    trainval_txt_path = os.path.join(voc_main_dir, <span class="hljs-string">&#x27;trainval.txt&#x27;</span>)<br>    val_txt_path = os.path.join(voc_main_dir, <span class="hljs-string">&#x27;val.txt&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(voc_main_dir):<br>        os.makedirs(voc_main_dir)<br><br>    <span class="hljs-comment"># 遍历图像文件夹，获取所有图像</span><br>    image_name_list = []<br>    <span class="hljs-keyword">for</span> image_name <span class="hljs-keyword">in</span> os.listdir(voc_image_dir):<br>        image_name_list.append(image_name)<br>    image_name_list = np.array(image_name_list)<br>    image_name_list = np.random.permutation(image_name_list)<br><br>    <span class="hljs-comment"># 划分训练集和测试集</span><br>    size = <span class="hljs-built_in">len</span>(image_name_list)<br>    random_index = np.random.permutation(size)<br>    train_size = <span class="hljs-built_in">int</span>(size * train_ratio)<br>    train_image_name_list = image_name_list[random_index[<span class="hljs-number">0</span>:train_size]]<br>    val_image_name_list = image_name_list[random_index[train_size:]]<br><br>    <span class="hljs-comment"># 生成trainval</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(trainval_txt_path, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> image_name <span class="hljs-keyword">in</span> image_name_list:<br>            fname, ext = os.path.splitext(image_name)<br>            fname = <span class="hljs-string">&quot;./Images/&quot;</span> + fname + <span class="hljs-string">&quot;.jpg&quot;</span> + <span class="hljs-string">&quot;,&quot;</span> + <span class="hljs-string">&quot;./Annotations/&quot;</span> + fname + <span class="hljs-string">&quot;.xml&quot;</span><br>            f.write(fname + <span class="hljs-string">&quot;\n&quot;</span>)<br>    <span class="hljs-comment"># 生成train</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(train_txt_path, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> image_name <span class="hljs-keyword">in</span> train_image_name_list:<br>            fname, ext = os.path.splitext(image_name)<br>            fname = <span class="hljs-string">&quot;./Images/&quot;</span> + fname + <span class="hljs-string">&quot;.jpg&quot;</span> + <span class="hljs-string">&quot;,&quot;</span> + <span class="hljs-string">&quot;./Annotations/&quot;</span> + fname + <span class="hljs-string">&quot;.xml&quot;</span><br>            f.write(fname + <span class="hljs-string">&quot;\n&quot;</span>)<br>    <span class="hljs-comment"># 生成val</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(val_txt_path, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> image_name <span class="hljs-keyword">in</span> val_image_name_list:<br>            fname, ext = os.path.splitext(image_name)<br>            fname = <span class="hljs-string">&quot;./Images/&quot;</span> + fname + <span class="hljs-string">&quot;.jpg&quot;</span> + <span class="hljs-string">&quot;,&quot;</span> + <span class="hljs-string">&quot;./Annotations/&quot;</span> + fname + <span class="hljs-string">&quot;.xml&quot;</span><br>            f.write(fname + <span class="hljs-string">&quot;\n&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run_main</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    这是主函数</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    train_ratio = <span class="hljs-number">0.8</span><br>    <span class="hljs-comment"># voc_dataset_dir = os.path.abspath(&quot;./&quot;),</span><br>    voc_dataset_dir = <span class="hljs-string">&#x27;./&#x27;</span><br>    random_split_voc_dataset(voc_dataset_dir, train_ratio)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    run_main()<br></code></pre></td></tr></table></figure>
<h2 id="Paddle模型预测（mobilenet-ssd）">Paddle模型预测（mobilenet_ssd）</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-comment"># 引用 paddle inference 预测库</span><br><span class="hljs-keyword">import</span> paddle.inference <span class="hljs-keyword">as</span> paddle_infer<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br><span class="hljs-comment"># 创建 config</span><br>config = paddle_infer.Config(<span class="hljs-string">&quot;./models/mobilenet_ssd/mobilenet-ssd-model&quot;</span>,<br>                             <span class="hljs-string">&quot;./models/mobilenet_ssd/mobilenet-ssd-params&quot;</span>)<br><br><span class="hljs-comment"># 根据 config 创建 predictor</span><br>predictor = paddle_infer.create_predictor(config)<br><br><span class="hljs-comment"># 获取输入 Tensor</span><br>input_names = predictor.get_input_names()<br>input_tensor = predictor.get_input_handle(input_names[<span class="hljs-number">0</span>])<br><br><span class="hljs-built_in">print</span>(input_names)<br><span class="hljs-built_in">print</span>(input_tensor)<br><br><span class="hljs-comment"># 从 CPU 获取数据，设置到 Tensor 内部</span><br>imgPath = <span class="hljs-string">&#x27;./frame/15.jpg&#x27;</span><br><br>cap = cv2.VideoCapture(<span class="hljs-string">&#x27;./models/mobilenet_ssd/sample.mp4&#x27;</span>)<br>frame = []<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    ret, frame = cap.read()<br>    <span class="hljs-keyword">if</span> ret == <span class="hljs-literal">False</span>:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-comment"># cv2.imwrite(&quot;./frame/frame.jpg&quot;, frame)</span><br>    <span class="hljs-comment"># imgPath = &#x27;./frame/frame.jpg&#x27;</span><br>    im = Image.fromarray(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB))<span class="hljs-comment"># Image.open(imgPath)</span><br>    im = im.resize((<span class="hljs-number">300</span>, <span class="hljs-number">300</span>), Image.BICUBIC)<br><br>    <span class="hljs-comment"># img = cv2.cvtColor(numpy.asarray(im.resize((320, 240), Image.BICUBIC)), cv2.COLOR_RGB2BGR)#cv2.cvtColor(, cv2.COLOR_RGB2BGR)  # 转换代码</span><br>    <span class="hljs-comment"># cv2.imshow(&#x27;img&#x27;, img)  # opencv显示</span><br>    <span class="hljs-comment"># cv2.waitKey()</span><br><br>    im = np.array(im, dtype=np.float32).transpose(<span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>).reshape((<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">300</span>, <span class="hljs-number">300</span>))<br>    mean = [<span class="hljs-number">121.636447</span>, <span class="hljs-number">125.696666</span>, <span class="hljs-number">124.807721</span>]<br>    <span class="hljs-comment"># mean = [127.5, 127.5, 127.5]</span><br>    scale = [<span class="hljs-number">0.007843</span>,<br>             <span class="hljs-number">0.007843</span>,<br>             <span class="hljs-number">0.007843</span>]<br>    std = [ <span class="hljs-number">69.480526</span>,<br>            <span class="hljs-number">66.625320</span>,<br>            <span class="hljs-number">50.616609</span>]<br><br>    <span class="hljs-keyword">for</span> ri <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">300</span>):<br>        im[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][ri] = (im[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][ri] / <span class="hljs-number">255</span>)<span class="hljs-comment"># - (scale[0] - mean[0] / 255)</span><br>    <span class="hljs-keyword">for</span> gi <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">300</span>):<br>        im[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>][gi] = (im[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>][gi] / <span class="hljs-number">255</span>)<span class="hljs-comment"># - (scale[1] - mean[1] / 255)</span><br>    <span class="hljs-keyword">for</span> bi <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">300</span>):<br>        im[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>][bi] = (im[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>][bi] / <span class="hljs-number">255</span>)<span class="hljs-comment"># - (scale[2] - mean[2] / 255)</span><br><br>    fake_input = im<br><br>    input_tensor1 = predictor.get_input_handle(input_names[<span class="hljs-number">0</span>])<br>    input_tensor1.copy_from_cpu(im)<br>    <span class="hljs-comment">#</span><br>    <span class="hljs-comment"># im = np.asarray([[320.0/240.0, 320.0/320.0]], dtype=np.float32)</span><br>    <span class="hljs-comment"># input_tensor2 = predictor.get_input_handle(input_names[1])</span><br>    <span class="hljs-comment"># input_tensor2.copy_from_cpu(im)</span><br>    <span class="hljs-comment">#</span><br>    <span class="hljs-comment"># im = np.asarray([[608, 608]], dtype=np.float32)</span><br>    <span class="hljs-comment"># input_tensor2 = predictor.get_input_handle(input_names[2])</span><br>    <span class="hljs-comment"># input_tensor2.copy_from_cpu(im)</span><br><br>    <span class="hljs-comment"># 执行预测</span><br>    predictor.run()<br><br>    <span class="hljs-comment"># 获取输出 Tensor</span><br>    output_names = predictor.get_output_names()<br>    output_tensor = predictor.get_output_handle(output_names[<span class="hljs-number">0</span>])<br><br>    <span class="hljs-comment"># 从 Tensor 中获取数据到 CPU</span><br>    output_data = output_tensor.copy_to_cpu()<br><br>    <span class="hljs-comment"># 获取 Tensor 的维度信息</span><br>    output_shape = output_tensor.shape()<br><br>    <span class="hljs-comment"># 获取 Tensor 的数据类型</span><br>    output_type = output_tensor.<span class="hljs-built_in">type</span>()<br><br>    results = []<br>    i = <span class="hljs-number">0</span><br>    img = frame<br>    label_list = [<span class="hljs-string">&quot;background&quot;</span>, <span class="hljs-string">&quot;cone&quot;</span>, <span class="hljs-string">&quot;bridge&quot;</span>, <span class="hljs-string">&quot;pig&quot;</span>, <span class="hljs-string">&quot;tractor&quot;</span>, <span class="hljs-string">&quot;corn&quot;</span>, <span class="hljs-string">&quot;bump&quot;</span>, <span class="hljs-string">&quot;crosswalk&quot;</span>, <span class="hljs-string">&quot; &quot;</span>]<br>    label_list = [<span class="hljs-string">&quot;background&quot;</span>, <span class="hljs-string">&quot;cone&quot;</span>, <span class="hljs-string">&quot;granary&quot;</span>, <span class="hljs-string">&quot;bridge&quot;</span>, <span class="hljs-string">&quot;tractor&quot;</span>, <span class="hljs-string">&quot;corn&quot;</span>, <span class="hljs-string">&quot;pig&quot;</span>, <span class="hljs-string">&quot;crosswalk&quot;</span>, <span class="hljs-string">&quot;bump&quot;</span>]<br>    img = cv2.resize(img, dsize=(<span class="hljs-number">300</span>, <span class="hljs-number">300</span>), fx=<span class="hljs-number">1</span>, fy=<span class="hljs-number">1</span>, interpolation=cv2.INTER_LINEAR)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(output_data) &gt; <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> output_data:<br>            tmp = &#123;&#125;<br>            <span class="hljs-keyword">if</span> data[<span class="hljs-number">1</span>] &gt; <span class="hljs-number">0.9</span>:<br>                tmp[<span class="hljs-string">&#x27;type&#x27;</span>] = data[<span class="hljs-number">0</span>]<br>                tmp[<span class="hljs-string">&#x27;score&#x27;</span>] = data[<span class="hljs-number">1</span>]<br>                tmp[<span class="hljs-string">&#x27;x&#x27;</span>] = data[<span class="hljs-number">2</span>] * <span class="hljs-number">300</span><br>                tmp[<span class="hljs-string">&#x27;y&#x27;</span>] = data[<span class="hljs-number">3</span>] * <span class="hljs-number">300</span><br>                tmp[<span class="hljs-string">&#x27;width&#x27;</span>] = data[<span class="hljs-number">4</span>] * <span class="hljs-number">300</span> - tmp[<span class="hljs-string">&#x27;x&#x27;</span>]<br>                tmp[<span class="hljs-string">&#x27;height&#x27;</span>] = data[<span class="hljs-number">5</span>] * <span class="hljs-number">300</span> - tmp[<span class="hljs-string">&#x27;y&#x27;</span>]<br>                results.insert(i, tmp)<br>                <span class="hljs-comment"># print(tmp)</span><br>                i = i + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> results:<br>            x = <span class="hljs-built_in">int</span>(i[<span class="hljs-string">&#x27;x&#x27;</span>])<br>            xmax =  <span class="hljs-built_in">int</span>(i[<span class="hljs-string">&#x27;x&#x27;</span>] + i[<span class="hljs-string">&#x27;width&#x27;</span>])<br>            y = <span class="hljs-built_in">int</span>(i[<span class="hljs-string">&#x27;y&#x27;</span>])<br>            ymax = <span class="hljs-built_in">int</span>(i[<span class="hljs-string">&#x27;y&#x27;</span>] + i[<span class="hljs-string">&#x27;height&#x27;</span>])<br>            <span class="hljs-comment"># print((x, y), (xmax, ymax))</span><br>            cv2.rectangle(img, (x, y), (xmax, ymax), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>), <span class="hljs-number">2</span>)<br>            <span class="hljs-comment"># cv2.rectangle(img, (x, ymax), (xmax, y), (255, 0, 0), 2)</span><br>            cv2.putText(img,<br>                        <span class="hljs-built_in">str</span>(label_list[<span class="hljs-built_in">int</span>(i[<span class="hljs-string">&#x27;type&#x27;</span>])]),<br>                        (<span class="hljs-built_in">int</span>(x), <span class="hljs-built_in">int</span>(y)),<br>                        cv2.FONT_HERSHEY_SIMPLEX,<br>                        <span class="hljs-number">0.75</span>,<br>                        (<span class="hljs-number">0</span>, <span class="hljs-built_in">int</span>(i[<span class="hljs-string">&#x27;type&#x27;</span>]) * <span class="hljs-number">30</span>, <span class="hljs-number">255</span>),<br>                        <span class="hljs-number">2</span>)<br>    img = cv2.resize(img, dsize=(<span class="hljs-number">320</span>, <span class="hljs-number">240</span>), fx=<span class="hljs-number">1</span>, fy=<span class="hljs-number">1</span>, interpolation=cv2.INTER_LINEAR)<br>    cv2.imshow(<span class="hljs-string">&#x27;src&#x27;</span>, img)<br>    cv2.waitKey(<span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># 释放中间 Tensor</span><br>predictor.clear_intermediate_tensor()<br><br><span class="hljs-comment"># 释放内存池中的所有临时 Tensor</span><br>predictor.try_shrink_memory()<br></code></pre></td></tr></table></figure>
<h2 id="xml文件解析（paddle官方数据标注格式下）">xml文件解析（paddle官方数据标注格式下）</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> xml.dom.minidom<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getXMLData</span>(<span class="hljs-params">xml_file</span>):<br>    <span class="hljs-comment"># 打开xml文档</span><br>    dom = xml.dom.minidom.parse(xml_file)<br><br>    <span class="hljs-comment"># 得到文档元素对象</span><br>    root = dom.documentElement<br><br>    filename = root.getElementsByTagName(<span class="hljs-string">&#x27;filename&#x27;</span>)[<span class="hljs-number">0</span>].firstChild.data<br><br>    <span class="hljs-comment"># object_num = root.getElementsByTagName(&#x27;object_num&#x27;)[0].firstChild.data</span><br><br>    <span class="hljs-built_in">object</span> = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> root.getElementsByTagName(<span class="hljs-string">&#x27;object&#x27;</span>):<br>        name = i.getElementsByTagName(<span class="hljs-string">&#x27;name&#x27;</span>)[<span class="hljs-number">0</span>].firstChild.data<br>        <span class="hljs-comment"># difficult = i.getElementsByTagName(&#x27;difficult&#x27;)[0].firstChild.data</span><br>        bndbox = i.getElementsByTagName(<span class="hljs-string">&#x27;bndbox&#x27;</span>)[<span class="hljs-number">0</span>]<br>        xmin = bndbox.getElementsByTagName(<span class="hljs-string">&#x27;xmin&#x27;</span>)[<span class="hljs-number">0</span>].firstChild.data<br>        ymin = bndbox.getElementsByTagName(<span class="hljs-string">&#x27;ymin&#x27;</span>)[<span class="hljs-number">0</span>].firstChild.data<br>        xmax = bndbox.getElementsByTagName(<span class="hljs-string">&#x27;xmax&#x27;</span>)[<span class="hljs-number">0</span>].firstChild.data<br>        ymax = bndbox.getElementsByTagName(<span class="hljs-string">&#x27;ymax&#x27;</span>)[<span class="hljs-number">0</span>].firstChild.data<br><br>        data = &#123;<span class="hljs-string">&#x27;name&#x27;</span>: name,<br>                <span class="hljs-comment"># &#x27;difficult&#x27;: difficult,</span><br>                <span class="hljs-string">&#x27;xmin&#x27;</span>: xmin,<br>                <span class="hljs-string">&#x27;ymin&#x27;</span>: ymin,<br>                <span class="hljs-string">&#x27;xmax&#x27;</span>: xmax,<br>                <span class="hljs-string">&#x27;ymax&#x27;</span>: ymax&#125;<br><br>        <span class="hljs-built_in">object</span>.append(data)<br>    <span class="hljs-comment"># print(root.nodeName)</span><br>    <span class="hljs-comment"># print (filename)</span><br>    <span class="hljs-comment"># print(object)</span><br>    <span class="hljs-keyword">return</span> filename, <span class="hljs-built_in">object</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    data_path = <span class="hljs-string">&#x27;./Car2024/&#x27;</span><br>    xml_file = data_path + <span class="hljs-string">&quot;/Annotations/block10.xml&quot;</span><br>    filename, <span class="hljs-built_in">object</span> = getXMLData(xml_file)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">object</span>))<br></code></pre></td></tr></table></figure>
<h1>JAVA</h1>
<h2 id="Pair-Key-Value">Pair&lt;Key, Value&gt;</h2>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> util;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Pair</span>&lt;K, V&gt; &#123;<br><br>    <span class="hljs-keyword">private</span> K key;<br>    <span class="hljs-keyword">private</span> V value;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Pair</span><span class="hljs-params">(K key, V value)</span> &#123;<br>        <span class="hljs-built_in">this</span>.key = key;<br>        <span class="hljs-built_in">this</span>.value = value;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;K, V&gt; Pair&lt;K, V&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(K key, V value)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Pair</span>&lt;&gt;(key, value);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> K <span class="hljs-title function_">getKey</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> key;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> V <span class="hljs-title function_">getValue</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> value;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">if</span> (key == <span class="hljs-literal">null</span> &amp;&amp; value == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">if</span> (key == <span class="hljs-literal">null</span> &amp;&amp; value <span class="hljs-keyword">instanceof</span> String) <span class="hljs-keyword">return</span> value.toString();<br>        <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">null</span> &amp;&amp; key <span class="hljs-keyword">instanceof</span> String) <span class="hljs-keyword">return</span> key.toString();<br>        <span class="hljs-keyword">if</span> (key == <span class="hljs-literal">null</span> || value == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">return</span> key.toString() + value.toString();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">equals</span><span class="hljs-params">(Pair&lt;K, V&gt; obj)</span> &#123;<br>        <span class="hljs-keyword">if</span> (obj == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">return</span> obj.getKey().equals(getKey()) &amp;&amp; obj.getValue().equals(getValue());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="字符串分段排序">字符串分段排序</h2>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> common;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.Collections;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sort</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * sort StringList</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> strArr split array.</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> seqStr For split strings, if you need take some content before the seqStr, then this item needs to be adjusted.</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> interval inserting content between results.</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> sorted ans.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">stringSort</span><span class="hljs-params">(String[] strArr, String seqStr, String interval)</span>&#123;<br>        <span class="hljs-comment">//分割后字符串子串列表</span><br>        <span class="hljs-comment">//[P1012, John Li, 01/01/2000, C001, T001]</span><br>        List&lt;List&lt;String&gt;&gt; splitList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        List&lt;String&gt; stringList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>        <span class="hljs-keyword">for</span> (String str : strArr)&#123;<br>            splitList.add(List.of(str.split(seqStr)));<br>            stringList.add(str);<br>        &#125;<br><br>        quickSort(stringList,splitList,<span class="hljs-number">0</span>,stringList.size()-<span class="hljs-number">1</span>);<br><br>        <span class="hljs-type">WordUtil</span> <span class="hljs-variable">words</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WordUtil</span>(interval, stringList, <span class="hljs-literal">false</span>);<br>        <span class="hljs-keyword">return</span> words.getResult();<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">quickSort</span><span class="hljs-params">(List&lt;String&gt; stringList, List&lt;List&lt;String&gt;&gt; splitList, <span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right)</span>&#123;<br>        <span class="hljs-keyword">if</span>(left &lt; right)&#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">pivot</span> <span class="hljs-operator">=</span> partition(stringList, splitList, left, right);<br>            quickSort(stringList, splitList, left, pivot-<span class="hljs-number">1</span>);<br>            quickSort(stringList, splitList, pivot+<span class="hljs-number">1</span>, right);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">partition</span><span class="hljs-params">(List&lt;String&gt; stringList, List&lt;List&lt;String&gt;&gt; splitList, <span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right)</span>&#123;<br>        List&lt;String&gt; pivot = splitList.get(left);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> left + <span class="hljs-number">1</span>, j = right;<br>        <span class="hljs-keyword">while</span>(i &lt;= j)&#123;<br>            <span class="hljs-keyword">while</span>(i &lt;= j &amp;&amp; strListCmp(splitList.get(i),pivot) &lt;= <span class="hljs-number">0</span>) i++;<br>            <span class="hljs-keyword">while</span>(i &lt;= j &amp;&amp; strListCmp(splitList.get(j),pivot) &gt; <span class="hljs-number">0</span>) j--;<br>            <span class="hljs-keyword">if</span>(i &lt; j)&#123;<br>                Collections.swap(splitList, i, j);<br>                Collections.swap(stringList, i, j);<br>            &#125;<br>        &#125;<br>        Collections.swap(splitList, left, j);<br>        Collections.swap(stringList, left, j);<br>        <span class="hljs-keyword">return</span> j;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">strListCmp</span><span class="hljs-params">(List&lt;String&gt; str1, List&lt;String&gt; str2)</span>&#123;<br>        <span class="hljs-keyword">if</span>(str1.size() &gt; str2.size())&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(str1.size() &lt; str2.size())&#123;<br>            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; str1.size(); i++) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">error</span> <span class="hljs-operator">=</span> str1.get(i).compareTo(str2.get(i));<br>            <span class="hljs-keyword">if</span> (error != <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">return</span> error;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
<h1>HTML</h1>
<h2 id="midi播放可视化1">midi播放可视化1</h2>
<p>参考文章：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_66711291/article/details/131724443">Pixi + Tone 实现简单midi音频可视化_tone.js节拍器-CSDN博客</a></p>
<p>代码实现效果：</p>
<p><a target="_blank" rel="noopener" href="https://www.drluo.top/friends/self/midivisualization/index.html">网页详情</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Midi可视化<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./js/Tone.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./js/Midi.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./js/pixi.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;file&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;play&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;播放&quot;</span>/&gt;</span><br>	<br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">	<span class="hljs-keyword">const</span> <span class="hljs-title class_">Application</span> = <span class="hljs-variable constant_">PIXI</span>.<span class="hljs-property">Application</span>;  <span class="hljs-comment">// 应用类，快速创建PIXI应用</span></span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> <span class="hljs-title class_">Sprite</span> = <span class="hljs-variable constant_">PIXI</span>.<span class="hljs-property">Sprite</span>;            <span class="hljs-comment">// 精灵类</span></span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> <span class="hljs-title class_">Graphics</span> = <span class="hljs-variable constant_">PIXI</span>.<span class="hljs-property">Graphics</span>;        <span class="hljs-comment">// 图形类</span></span><br><span class="language-javascript">    <span class="hljs-comment">// 创建应用程序并挂载</span></span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> pixi = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Application</span>(&#123;</span><br><span class="language-javascript">      <span class="hljs-attr">width</span>: <span class="hljs-number">1000</span>,</span><br><span class="language-javascript">      <span class="hljs-attr">height</span>: <span class="hljs-number">600</span>,</span><br><span class="language-javascript">      <span class="hljs-attr">backgroundColor</span>: <span class="hljs-number">0x000000</span></span><br><span class="language-javascript">    &#125;)</span><br><span class="language-javascript">    <span class="hljs-comment">// pixi.view 代表画布，是一个canvas元素</span></span><br><span class="language-javascript">    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(pixi.<span class="hljs-property">view</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">	<span class="hljs-keyword">const</span> config = &#123;</span><br><span class="language-javascript">		  <span class="hljs-attr">speed</span>: <span class="hljs-number">1</span>,</span><br><span class="language-javascript">		  <span class="hljs-attr">leftColor</span>: <span class="hljs-number">0xFF69B4</span>,</span><br><span class="language-javascript">		  <span class="hljs-attr">rightColor</span>: <span class="hljs-number">0x00BFFF</span>,</span><br><span class="language-javascript">		  <span class="hljs-attr">color1</span>: <span class="hljs-number">0x66A9C9</span>,</span><br><span class="language-javascript">		  <span class="hljs-attr">color2</span>: <span class="hljs-number">0xF0C9CF</span>,</span><br><span class="language-javascript">		  <span class="hljs-attr">color3</span>: <span class="hljs-number">0xE2C17C</span>,</span><br><span class="language-javascript">		  <span class="hljs-attr">color4</span>: <span class="hljs-number">0x363433</span>,</span><br><span class="language-javascript">		  <span class="hljs-attr">color5</span>: <span class="hljs-number">0xFF4500</span>,</span><br><span class="language-javascript">		&#125;</span><br><span class="language-javascript">	<span class="hljs-comment">// 定义灯光类作为音符的可视化</span></span><br><span class="language-javascript">	<span class="hljs-keyword">class</span> <span class="hljs-title class_">Light</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Graphics</span> &#123;</span><br><span class="language-javascript">	  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">color, height, x</span>) &#123;</span><br><span class="language-javascript">		<span class="hljs-variable language_">super</span>();</span><br><span class="language-javascript">		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">beginFill</span>(color);</span><br><span class="language-javascript">		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawRect</span>(x, <span class="hljs-number">600</span>, <span class="hljs-number">10</span>, height);</span><br><span class="language-javascript">		<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">endFill</span>();</span><br><span class="language-javascript">		<span class="hljs-comment">// pixijs的定时器，可以实现每帧执行一次，并且十分稳定</span></span><br><span class="language-javascript">		pixi.<span class="hljs-property">ticker</span>.<span class="hljs-title function_">add</span>(<span class="hljs-function">() =&gt;</span> &#123;</span><br><span class="language-javascript">		  <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> -= config.<span class="hljs-property">speed</span> * <span class="hljs-number">5</span>;</span><br><span class="language-javascript">		&#125;);</span><br><span class="language-javascript">	  &#125;</span><br><span class="language-javascript">	&#125;</span><br><span class="language-javascript">	<span class="hljs-comment">// pixi.stage 代表舞台，所有的物体必须挂载在舞台上才可以显示。</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> input = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#file&#x27;</span>);</span><br><span class="language-javascript">    input.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;change&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;</span><br><span class="language-javascript">      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">files</span>[<span class="hljs-number">0</span>]);</span><br><span class="language-javascript">	  <span class="hljs-title function_">parseMidi</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">files</span>[<span class="hljs-number">0</span>]);</span><br><span class="language-javascript">    &#125;)</span><br><span class="language-javascript">	</span><br><span class="language-javascript">    <span class="hljs-comment">// 读取midi文件</span></span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">parseMidi</span>(<span class="hljs-params">file</span>) &#123;</span><br><span class="language-javascript">      <span class="hljs-comment">// 创建文件读取器</span></span><br><span class="language-javascript">      <span class="hljs-keyword">const</span> reader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileReader</span>();</span><br><span class="language-javascript">      <span class="hljs-comment">// 读取文件</span></span><br><span class="language-javascript">      reader.<span class="hljs-title function_">readAsArrayBuffer</span>(file);</span><br><span class="language-javascript">      <span class="hljs-comment">// 文件读取完成后将文件转化为json对象</span></span><br><span class="language-javascript">      reader.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;load&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;</span><br><span class="language-javascript">        currentMidi = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Midi</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(currentMidi);</span><br><span class="language-javascript">      &#125;)</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">	</span><br><span class="language-javascript">	play.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;</span><br><span class="language-javascript">      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(currentMidi);</span><br><span class="language-javascript">      <span class="hljs-comment">// 如果未加载midi文件</span></span><br><span class="language-javascript">      <span class="hljs-keyword">if</span>(!currentMidi) &#123;</span><br><span class="language-javascript">        <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;未加载文件&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">      &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">      <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Tone</span>.<span class="hljs-title function_">now</span>() + <span class="hljs-number">0.5</span>; <span class="hljs-comment">// 获取当前时间</span></span><br><span class="language-javascript">      <span class="hljs-keyword">const</span> synths = [];            <span class="hljs-comment">// 存储合成器</span></span><br><span class="language-javascript">      <span class="hljs-comment">// 遍历midi文件中的轨道</span></span><br><span class="language-javascript">      currentMidi.<span class="hljs-property">tracks</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">track</span> =&gt;</span> &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">// 创建合成器作为音轨并连接至出口，音色使用Tonejs的默认音色</span></span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> synth = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Tone</span>.<span class="hljs-title class_">PolySynth</span>(<span class="hljs-title class_">Tone</span>.<span class="hljs-property">Synth</span>, &#123;</span><br><span class="language-javascript">					<span class="hljs-attr">envelope</span>: &#123;</span><br><span class="language-javascript">						<span class="hljs-comment">// 声音的生命周期：按下按键 - 渐入 - 攻击阶段 - 衰减阶段 - 衰减结束 - 松开按键 - 声音消逝</span></span><br><span class="language-javascript">						</span><br><span class="language-javascript">						&lt;!-- <span class="hljs-comment">// 旧 --&gt;</span></span><br><span class="language-javascript">						&lt;!-- <span class="hljs-attr">attack</span>: <span class="hljs-number">0.02</span>,     <span class="hljs-comment">// 渐入时间 --&gt;</span></span><br><span class="language-javascript">						&lt;!-- <span class="hljs-attr">decay</span>: <span class="hljs-number">0.1</span>,       <span class="hljs-comment">// 攻击阶段（最大音量）持续时间 --&gt;</span></span><br><span class="language-javascript">						&lt;!-- <span class="hljs-attr">sustain</span>: <span class="hljs-number">0.3</span>,     <span class="hljs-comment">// 衰减结束后的最小声音 --&gt;</span></span><br><span class="language-javascript">						&lt;!-- <span class="hljs-attr">release</span>: <span class="hljs-number">1</span>,       <span class="hljs-comment">// 从松开按键到声音彻底消失所需的时间 --&gt;</span></span><br><span class="language-javascript">						</span><br><span class="language-javascript">						<span class="hljs-comment">// Piano</span></span><br><span class="language-javascript">						<span class="hljs-attr">attack</span>: <span class="hljs-number">0.005</span>,     <span class="hljs-comment">// 渐入时间</span></span><br><span class="language-javascript">						<span class="hljs-attr">decay</span>: <span class="hljs-number">1.5</span>,       <span class="hljs-comment">// 攻击阶段（最大音量）持续时间</span></span><br><span class="language-javascript">						<span class="hljs-attr">sustain</span>: <span class="hljs-number">0.05</span>,     <span class="hljs-comment">// 衰减结束后的最小声音</span></span><br><span class="language-javascript">						<span class="hljs-attr">release</span>: <span class="hljs-number">0.005</span>,       <span class="hljs-comment">// 从松开按键到声音彻底消失所需的时间</span></span><br><span class="language-javascript">					&#125;,</span><br><span class="language-javascript">				&#125;).<span class="hljs-title function_">toDestination</span>();</span><br><span class="language-javascript">		<span class="hljs-comment">// 将合成器存储起来，为之后停止播放的功能留下接口。</span></span><br><span class="language-javascript">        synths.<span class="hljs-title function_">push</span>(synth);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 遍历轨道中的每个音符</span></span><br><span class="language-javascript">        track.<span class="hljs-property">notes</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">note</span> =&gt;</span> &#123;</span><br><span class="language-javascript">          <span class="hljs-comment">// 合成器发声</span></span><br><span class="language-javascript">		  note.<span class="hljs-property">velocity</span> = note.<span class="hljs-property">velocity</span>/<span class="hljs-number">10</span>;</span><br><span class="language-javascript">          synth.<span class="hljs-title function_">triggerAttackRelease</span>(</span><br><span class="language-javascript">						note.<span class="hljs-property">name</span>,         <span class="hljs-comment">// 音名</span></span><br><span class="language-javascript">						note.<span class="hljs-property">duration</span>,     <span class="hljs-comment">// 持续时间</span></span><br><span class="language-javascript">						note.<span class="hljs-property">time</span> + now,   <span class="hljs-comment">// 开始发声时间</span></span><br><span class="language-javascript">						note.<span class="hljs-property">velocity</span>      <span class="hljs-comment">// 音量</span></span><br><span class="language-javascript">					);</span><br><span class="language-javascript">					</span><br><span class="language-javascript">			<span class="hljs-comment">// 在播放按钮的事件中，遍历音符时，创建音频调度，实现音画同步</span></span><br><span class="language-javascript">			<span class="hljs-title class_">Tone</span>.<span class="hljs-property">Transport</span>.<span class="hljs-title function_">schedule</span>(<span class="hljs-function">(<span class="hljs-params">time</span>) =&gt;</span> &#123;</span><br><span class="language-javascript">				<span class="hljs-comment">// 根据音调划分颜色，（其实应该根据轨道来划分的）</span></span><br><span class="language-javascript">				<span class="hljs-keyword">var</span> color = config.<span class="hljs-property">color1</span>;</span><br><span class="language-javascript">				<span class="hljs-keyword">if</span>(note.<span class="hljs-property">midi</span> &lt; <span class="hljs-number">15</span>) &#123;</span><br><span class="language-javascript">					color = config.<span class="hljs-property">color1</span>;</span><br><span class="language-javascript">				&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (note.<span class="hljs-property">midi</span> &lt; <span class="hljs-number">30</span>)&#123;					</span><br><span class="language-javascript">					color = config.<span class="hljs-property">color2</span>;</span><br><span class="language-javascript">				&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (note.<span class="hljs-property">midi</span> &lt; <span class="hljs-number">45</span>)&#123;</span><br><span class="language-javascript">					color = config.<span class="hljs-property">color3</span>;</span><br><span class="language-javascript">				&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (note.<span class="hljs-property">midi</span> &lt; <span class="hljs-number">60</span>)&#123;</span><br><span class="language-javascript">					color = config.<span class="hljs-property">color4</span>;</span><br><span class="language-javascript">				&#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">					color = config.<span class="hljs-property">color5</span>;</span><br><span class="language-javascript">				&#125;</span><br><span class="language-javascript">				<span class="hljs-comment">//color = &#x27;0x&#x27;+ Math.random().toString(16).substr(2,6);</span></span><br><span class="language-javascript">				pixi.<span class="hljs-property">stage</span>.<span class="hljs-title function_">addChild</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Light</span>(color, note.<span class="hljs-property">duration</span> * <span class="hljs-number">150</span> * config.<span class="hljs-property">speed</span>, (note.<span class="hljs-property">midi</span> - <span class="hljs-number">20</span>) * <span class="hljs-number">10</span>))</span><br><span class="language-javascript">				</span><br><span class="language-javascript">			&#125;, note.<span class="hljs-property">time</span> + now);</span><br><span class="language-javascript"></span><br><span class="language-javascript">			<span class="hljs-comment">// 在代码最外层设置音频调度的模式，并启动音频调度。</span></span><br><span class="language-javascript">			<span class="hljs-title class_">Tone</span>.<span class="hljs-property">context</span>.<span class="hljs-property">latencyHint</span> = <span class="hljs-string">&#x27;fastest&#x27;</span>;</span><br><span class="language-javascript">			<span class="hljs-title class_">Tone</span>.<span class="hljs-property">Transport</span>.<span class="hljs-title function_">start</span>();</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript">      &#125;);</span><br><span class="language-javascript">    &#125;)</span><br><span class="language-javascript">	</span><br><span class="language-javascript">	</span><br><span class="language-javascript">	</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure>
<hr>
<p>Tone.js文件，Midi.js文件，pixi.js文件：</p>
<p><a target="_blank" rel="noopener" href="https://www.drluo.top/friends/self/midivisualization/js/Tone.js">https://www.drluo.top/friends/self/midivisualization/js/Tone.js</a></p>
<p><a target="_blank" rel="noopener" href="https://www.drluo.top/friends/self/midivisualization/js/Midi.js">https://www.drluo.top/friends/self/midivisualization/js/Midi.js</a></p>
<p><a target="_blank" rel="noopener" href="https://www.drluo.top/friends/self/midivisualization/js/pixi.js">https://www.drluo.top/friends/self/midivisualization/js/pixi.js</a></p>
<h2 id="midi播放可视化2">midi播放可视化2</h2>
<p>由于<a target="_blank" rel="noopener" href="https://storage.googleapis.xn--com-rz1ek4i97fjs5adlmrw4a3ljwseky4blx1a">https://storage.googleapis.com网站国内可能无法访问</a>，所以此代码可能因为缺失音效而无法播放，暂未找到相关镜像替代，请等待后续修改。</p>
<p>由于上面的代码效果不好，找了几圈，看到了<a target="_blank" rel="noopener" href="https://cifkao.github.io/html-midi-player/">html-midi-player | Play and display MIDI files online (cifkao.github.io)</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Midi可视化<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> 	<span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> 		<span class="hljs-attr">href</span>=<span class="hljs-string">&quot;./css/style.css&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> 	<span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./js/core.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> 	<span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./js/index.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;content&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;main-content&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;main&quot;</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">midi-visualizer</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;piano-roll&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;mainVisualizer&quot;</span> </span><br><span class="hljs-tag">			<span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./mid/弱虫だって   咩栗X呜米.mid&quot;</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">midi-visualizer</span>&gt;</span><br><br>			<span class="hljs-tag">&lt;<span class="hljs-name">midi-player</span> </span><br><span class="hljs-tag">			<span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./mid/弱虫だって   咩栗X呜米.mid&quot;</span> </span><br><span class="hljs-tag">			<span class="hljs-attr">sound-font</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">visualizer</span>=<span class="hljs-string">&quot;#mainVisualizer&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;mainPlayer&quot;</span> <span class="hljs-attr">data-js-focus-visible</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br><br><br>				<span class="hljs-comment">&lt;!-- 播放/暂停进度条 --&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;controls stopped&quot;</span> <span class="hljs-attr">part</span>=<span class="hljs-string">&quot;control-panel&quot;</span>&gt;</span><br>				  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;play&quot;</span> <span class="hljs-attr">part</span>=<span class="hljs-string">&quot;play-button&quot;</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon play-icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;24&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;24&quot;</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;1.1&quot;</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">&quot;0 0 6.35 6.35&quot;</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span><br>				 <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;m4.4979 3.175-2.1167 1.5875v-3.175z&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;.70201&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon stop-icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;24&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;24&quot;</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;1.1&quot;</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">&quot;0 0 6.35 6.35&quot;</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span><br>				 <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;m1.8521 1.5875v3.175h0.92604v-3.175zm1.7198 0v3.175h0.92604v-3.175z&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;.24153&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon error-icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;24&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;24&quot;</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;1.1&quot;</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">&quot;0 0 6.35 6.35&quot;</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span><br>				 <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">transform</span>=<span class="hljs-string">&quot;scale(.26458)&quot;</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;m12 3.5a8.4993 8.4993 0 0 0-8.5 8.5 8.4993 8.4993 0 0 0 8.5 8.5 8.4993 8.4993 0 0 0 8.5-8.5 8.4993 8.4993 0 0 0-8.5-8.5zm-1.4062 3.5h3v6h-3v-6zm0 8h3v2h-3v-2z&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>				  <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>				  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">part</span>=<span class="hljs-string">&quot;time&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;current-time&quot;</span> <span class="hljs-attr">part</span>=<span class="hljs-string">&quot;current-time&quot;</span>&gt;</span>0:00<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span> / <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;total-time&quot;</span> <span class="hljs-attr">part</span>=<span class="hljs-string">&quot;total-time&quot;</span>&gt;</span>0:15<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>				  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;range&quot;</span> <span class="hljs-attr">min</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">max</span>=<span class="hljs-string">&quot;15.999984&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">step</span>=<span class="hljs-string">&quot;any&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;seek-bar&quot;</span> <span class="hljs-attr">part</span>=<span class="hljs-string">&quot;seek-bar&quot;</span>&gt;</span><br>				  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;overlay loading-overlay&quot;</span> <span class="hljs-attr">part</span>=<span class="hljs-string">&quot;loading-overlay&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>				<span class="hljs-comment">&lt;!-- 播放/暂停进度条 --&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">midi-player</span>&gt;</span><br>			<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;midiFile&quot;</span>&gt;</span>选择Midi文件:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;midiFile&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;midiFile&quot;</span> <span class="hljs-attr">accept</span>=<span class="hljs-string">&quot;audio/midi, audio/x-midi&quot;</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>	<br>	<span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span><br>  <br><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>代码实现效果：</p>
<p><a target="_blank" rel="noopener" href="https://www.drluo.top/friends/self/midivisualization/index2.html">网页详情</a></p>
<p>由于<a target="_blank" rel="noopener" href="https://storage.googleapis.xn--com-rz1ek4i97fjs5adlmrw4a3ljwseky4blx1a">https://storage.googleapis.com网站国内可能无法访问</a>，所以此代码可能因为缺失音效而无法播放，暂未找到相关镜像替代，请等待后续修改。</p>
<p>style.css文件，core.js文件，index.js文件：</p>
<p><a target="_blank" rel="noopener" href="https://www.drluo.top/friends/self/midivisualization/css/style.css">https://www.drluo.top/friends/self/midivisualization/css/style.css</a></p>
<p><a target="_blank" rel="noopener" href="https://www.drluo.top/friends/self/midivisualization/js/core.js">https://www.drluo.top/friends/self/midivisualization/js/core.js</a></p>
<p><a target="_blank" rel="noopener" href="https://www.drluo.top/friends/self/midivisualization/js/index.js">https://www.drluo.top/friends/self/midivisualization/js/index.js</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://luoy-oss.github.io">drluo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://luoy-oss.github.io/posts/35609">https://luoy-oss.github.io/posts/35609</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://luoy-oss.github.io" target="_blank">洛屿的小站</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python</a><a class="post-meta__tags" href="/tags/C%E8%AF%AD%E8%A8%80/">C语言</a><a class="post-meta__tags" href="/tags/C/">C++</a><a class="post-meta__tags" href="/tags/Java/">Java</a><a class="post-meta__tags" href="/tags/HTML/">HTML</a><a class="post-meta__tags" href="/tags/JavaScript/">JavaScript</a></div><div class="post_share"><div class="social-share" data-image="/img/cover/luoy.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/5959" title="PaddleDetection"><img class="cover" src="/img/cover/paddlepaddle.webp" onerror="onerror=null;src='/img/err_img404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">PaddleDetection</div></div></a></div><div class="next-post pull-right"><a href="/posts/52883" title="实验室C语言第一次考核题目讲解及相关代码解读"><img class="cover" src="/img/cover/C++.webp" onerror="onerror=null;src='/img/err_img404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">实验室C语言第一次考核题目讲解及相关代码解读</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/28732" title="C、C++其他关键字详解"><img class="cover" src="/img/cover/%E4%B8%83%E4%B8%83.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-10 20时41分06秒</div><div class="title">C、C++其他关键字详解</div></div></a></div><div><a href="/posts/7618" title="C、C++关键字"><img class="cover" src="/img/cover/%E4%B8%83%E4%B8%83.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-10 20时37分06秒</div><div class="title">C、C++关键字</div></div></a></div><div><a href="/posts/23650" title="C、C++控制语句关键字详解"><img class="cover" src="/img/cover/%E4%B8%83%E4%B8%83.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-10 20时39分06秒</div><div class="title">C、C++控制语句关键字详解</div></div></a></div><div><a href="/posts/229" title="C、C++存储类型关键字详解"><img class="cover" src="/img/cover/%E4%B8%83%E4%B8%83.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-10 20时40分06秒</div><div class="title">C、C++存储类型关键字详解</div></div></a></div><div><a href="/posts/48531" title="C、C++数据类型关键字详解"><img class="cover" src="/img/cover/%E4%B8%83%E4%B8%83.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-10 20时38分16秒</div><div class="title">C、C++数据类型关键字详解</div></div></a></div><div><a href="/posts/24095" title="C、C++数组，指针，指针数组，数组指针的区别"><img class="cover" src="/img/cover/%E4%B8%83%E4%B8%83.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-11 21时27分23秒</div><div class="title">C、C++数组，指针，指针数组，数组指针的区别</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://cravatar.cn/avatar/6fa57e21db3ba5961f18a8ae75d0a081" onerror="this.onerror=null;this.src='/img/err_img404.gif'" alt="avatar"/></div><div class="author-info__name">drluo</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">65</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">45</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/luoy-oss"><i class="fab fa-github"></i><span>送上星星</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/luoy-oss" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:wang2557657882@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">C&#x2F;C++</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E5%83%8F%E7%BB%8F%E8%BF%87bitset%E5%A4%84%E7%90%86%E4%B8%BA%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%90%8E%E5%86%8D%E8%BD%AC%E4%B8%BAuchar%E6%A0%BC%E5%BC%8F%E4%BE%BF%E4%BA%8E%E4%B8%B2%E5%8F%A3%E5%8F%91%E9%80%81%EF%BC%8C%E5%B9%B6%E6%94%AF%E6%8C%81%E8%A7%A3%E7%A0%81%E4%B8%BAuchar%E6%95%B0%E7%BB%84%EF%BC%88240-320%EF%BC%89-row-col"><span class="toc-number">1.1.</span> <span class="toc-text">图像经过bitset处理为二进制后再转为uchar格式便于串口发送，并支持解码为uchar数组（240 * 320）(row * col)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%BC%E9%9F%B3%E6%8E%92%E5%BA%8F"><span class="toc-number">1.2.</span> <span class="toc-text">拼音排序</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">Python</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mp42img"><span class="toc-number">2.1.</span> <span class="toc-text">mp42img</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#img2mp4"><span class="toc-number">2.2.</span> <span class="toc-text">img2mp4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E9%A2%91%E5%8A%A0%E9%80%9F"><span class="toc-number">2.3.</span> <span class="toc-text">视频加速</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E5%83%8FRGB%E5%9D%87%E5%80%BC-%E6%96%B9%E5%B7%AE%E8%AE%A1%E7%AE%97"><span class="toc-number">2.4.</span> <span class="toc-text">图像RGB均值&#x2F;方差计算</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VOC%E6%95%B0%E6%8D%AE%E9%9B%86%E5%88%97%E8%A1%A8%E8%8E%B7%E5%8F%96"><span class="toc-number">2.5.</span> <span class="toc-text">VOC数据集列表获取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VOC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%88%AB%E7%BB%9F%E8%AE%A1"><span class="toc-number">2.6.</span> <span class="toc-text">VOC数据类别统计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VOC%E6%95%B0%E6%8D%AE%E5%88%86%E9%85%8D"><span class="toc-number">2.7.</span> <span class="toc-text">VOC数据分配</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Paddle%E6%A8%A1%E5%9E%8B%E9%A2%84%E6%B5%8B%EF%BC%88mobilenet-ssd%EF%BC%89"><span class="toc-number">2.8.</span> <span class="toc-text">Paddle模型预测（mobilenet_ssd）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xml%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%EF%BC%88paddle%E5%AE%98%E6%96%B9%E6%95%B0%E6%8D%AE%E6%A0%87%E6%B3%A8%E6%A0%BC%E5%BC%8F%E4%B8%8B%EF%BC%89"><span class="toc-number">2.9.</span> <span class="toc-text">xml文件解析（paddle官方数据标注格式下）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">JAVA</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Pair-Key-Value"><span class="toc-number">3.1.</span> <span class="toc-text">Pair&lt;Key, Value&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%86%E6%AE%B5%E6%8E%92%E5%BA%8F"><span class="toc-number">3.2.</span> <span class="toc-text">字符串分段排序</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">HTML</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#midi%E6%92%AD%E6%94%BE%E5%8F%AF%E8%A7%86%E5%8C%961"><span class="toc-number">4.1.</span> <span class="toc-text">midi播放可视化1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#midi%E6%92%AD%E6%94%BE%E5%8F%AF%E8%A7%86%E5%8C%962"><span class="toc-number">4.2.</span> <span class="toc-text">midi播放可视化2</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('/img/cover/luoy.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2025 By drluo</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">你好啊, 欢迎来到 <a target="_blank" rel="noopener" href="https://www.drluo.top/">洛屿的小站</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="要试着换一下颜色模式吗？"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="我会变胖变瘦哦！"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/npm/instant.page/instantpage.min.js" type="module"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container').forEach(node => {
            if (node.hasAttribute('display')) {
              btf.wrap(node, 'div', { class: 'mathjax-overflow' })
            } else {
              btf.wrap(node, 'span', { class: 'mathjax-overflow' })
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = '/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://vercel.drluo.top',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://vercel.drluo.top',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script id="click-show-text" src="/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法制,爱国,敬业,诚信,友善" data-fontsize="10px" data-random="false" async="async"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="万能的全站搜索助手，参上。" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></body></html>