((t,e)=>{if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r,n=e();for(r in n)("object"==typeof exports?exports:t)[r]=n[r]}})("undefined"!=typeof self?self:this,function(){return r={507:(t,e,r)=>{function n(t){var e=[];return function t(e,r){for(var n=0;n<e.length;n++){var i=e[n];Array.isArray(i)?t(i,r):r.push(i)}}(t,e),e}r.r(e),r.d(e,{flatten:()=>n})},289:(t,e,r)=>{e.parseMidi=r(666),e.writeMidi=r(865)},666:t=>{function s(t){for(var c,u=new h(t),e=[];!u.eof();){var r=(()=>{var t,e={},r=(e.deltaTime=u.readVarInt(),u.readUInt8());if(240==(240&r)){if(255!==r){if(240==r)return e.type="sysEx",i=u.readVarInt(),e.data=u.readBytes(i),e;if(247==r)return e.type="endSysEx",i=u.readVarInt(),e.data=u.readBytes(i),e;throw"Unrecognised MIDI event type byte: "+r}e.meta=!0;var n=u.readUInt8(),i=u.readVarInt();switch(n){case 0:if(e.type="sequenceNumber",2!==i)throw"Expected length for sequenceNumber event is 2, got "+i;return e.number=u.readUInt16(),e;case 1:return e.type="text",e.text=u.readString(i),e;case 2:return e.type="copyrightNotice",e.text=u.readString(i),e;case 3:return e.type="trackName",e.text=u.readString(i),e;case 4:return e.type="instrumentName",e.text=u.readString(i),e;case 5:return e.type="lyrics",e.text=u.readString(i),e;case 6:return e.type="marker",e.text=u.readString(i),e;case 7:return e.type="cuePoint",e.text=u.readString(i),e;case 32:if(e.type="channelPrefix",1!=i)throw"Expected length for channelPrefix event is 1, got "+i;return e.channel=u.readUInt8(),e;case 33:if(e.type="portPrefix",1!=i)throw"Expected length for portPrefix event is 1, got "+i;return e.port=u.readUInt8(),e;case 47:if(e.type="endOfTrack",0!=i)throw"Expected length for endOfTrack event is 0, got "+i;return e;case 81:if(e.type="setTempo",3!=i)throw"Expected length for setTempo event is 3, got "+i;return e.microsecondsPerBeat=u.readUInt24(),e;case 84:if(e.type="smpteOffset",5!=i)throw"Expected length for smpteOffset event is 5, got "+i;var a=u.readUInt8();return e.frameRate={0:24,32:25,64:29,96:30}[96&a],e.hour=31&a,e.min=u.readUInt8(),e.sec=u.readUInt8(),e.frame=u.readUInt8(),e.subFrame=u.readUInt8(),e;case 88:if(e.type="timeSignature",4!=i)throw"Expected length for timeSignature event is 4, got "+i;return e.numerator=u.readUInt8(),e.denominator=1<<u.readUInt8(),e.metronome=u.readUInt8(),e.thirtyseconds=u.readUInt8(),e;case 89:if(e.type="keySignature",2!=i)throw"Expected length for keySignature event is 2, got "+i;return e.key=u.readInt8(),e.scale=u.readUInt8(),e;case 127:return e.type="sequencerSpecific",e.data=u.readBytes(i),e;default:return e.type="unknownMeta",e.data=u.readBytes(i),e.metatypeByte=n,e}}else{if(0==(128&r)){if(null===c)throw"Running status byte encountered before status byte";t=r,r=c,e.running=!0}else t=u.readUInt8(),c=r;var o=r>>4;switch(e.channel=15&r,o){case 8:return e.type="noteOff",e.noteNumber=t,e.velocity=u.readUInt8(),e;case 9:var s=u.readUInt8();return e.type=0===s?"noteOff":"noteOn",e.noteNumber=t,0===(e.velocity=s)&&(e.byte9=!0),e;case 10:return e.type="noteAftertouch",e.noteNumber=t,e.amount=u.readUInt8(),e;case 11:return e.type="controller",e.controllerType=t,e.value=u.readUInt8(),e;case 12:return e.type="programChange",e.programNumber=t,e;case 13:return e.type="channelAftertouch",e.amount=t,e;case 14:return e.type="pitchBend",e.value=t+(u.readUInt8()<<7)-8192,e;default:throw"Unrecognised MIDI event type: "+o}}})();e.push(r)}return e}function h(t){this.buffer=t,this.bufferLen=this.buffer.length,this.pos=0}h.prototype.eof=function(){return this.pos>=this.bufferLen},h.prototype.readUInt8=function(){var t=this.buffer[this.pos];return this.pos+=1,t},h.prototype.readInt8=function(){var t=this.readUInt8();return 128&t?t-256:t},h.prototype.readUInt16=function(){return(this.readUInt8()<<8)+this.readUInt8()},h.prototype.readInt16=function(){var t=this.readUInt16();return 32768&t?t-65536:t},h.prototype.readUInt24=function(){return(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},h.prototype.readInt24=function(){var t=this.readUInt24();return 8388608&t?t-16777216:t},h.prototype.readUInt32=function(){return(this.readUInt8()<<24)+(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},h.prototype.readBytes=function(t){var e=this.buffer.slice(this.pos,this.pos+t);return this.pos+=t,e},h.prototype.readString=function(t){t=this.readBytes(t);return String.fromCharCode.apply(null,t)},h.prototype.readVarInt=function(){for(var t=0;!this.eof();){var e=this.readUInt8();if(!(128&e))return t+e;t=t+(127&e)<<7}return t},h.prototype.readChunk=function(){var t=this.readString(4),e=this.readUInt32();return{id:t,length:e,data:this.readBytes(e)}},t.exports=function(t){var e=new h(t),t=e.readChunk();if("MThd"!=t.id)throw"Bad MIDI file.  Expected 'MHdr', got: '"+t.id+"'";t=new h(t.data),r={format:t.readUInt16(),numTracks:t.readUInt16()},32768&(t=t.readUInt16())?(r.framesPerSecond=256-(t>>8),r.ticksPerFrame=255&t):r.ticksPerBeat=t;for(var r,n=r,i=[],a=0;!e.eof()&&a<n.numTracks;a++){var o=e.readChunk();if("MTrk"!=o.id)throw"Bad MIDI file.  Expected 'MTrk', got: '"+o.id+"'";o=s(o.data);i.push(o)}return{header:n,tracks:i}}},865:t=>{function h(t,e,r){for(var n=new p,i=e.length,a=null,o=0;o<i;o++)!1!==r.running&&(r.running||e[o].running)||(a=null),a=((t,e,r,n)=>{var i=e.type,a=e.deltaTime,o=e.text||"",s=e.data||[],c=null;switch(t.writeVarInt(a),i){case"sequenceNumber":t.writeUInt8(255),t.writeUInt8(0),t.writeVarInt(2),t.writeUInt16(e.number);break;case"text":t.writeUInt8(255),t.writeUInt8(1),t.writeVarInt(o.length),t.writeString(o);break;case"copyrightNotice":t.writeUInt8(255),t.writeUInt8(2),t.writeVarInt(o.length),t.writeString(o);break;case"trackName":t.writeUInt8(255),t.writeUInt8(3),t.writeVarInt(o.length),t.writeString(o);break;case"instrumentName":t.writeUInt8(255),t.writeUInt8(4),t.writeVarInt(o.length),t.writeString(o);break;case"lyrics":t.writeUInt8(255),t.writeUInt8(5),t.writeVarInt(o.length),t.writeString(o);break;case"marker":t.writeUInt8(255),t.writeUInt8(6),t.writeVarInt(o.length),t.writeString(o);break;case"cuePoint":t.writeUInt8(255),t.writeUInt8(7),t.writeVarInt(o.length),t.writeString(o);break;case"channelPrefix":t.writeUInt8(255),t.writeUInt8(32),t.writeVarInt(1),t.writeUInt8(e.channel);break;case"portPrefix":t.writeUInt8(255),t.writeUInt8(33),t.writeVarInt(1),t.writeUInt8(e.port);break;case"endOfTrack":t.writeUInt8(255),t.writeUInt8(47),t.writeVarInt(0);break;case"setTempo":t.writeUInt8(255),t.writeUInt8(81),t.writeVarInt(3),t.writeUInt24(e.microsecondsPerBeat);break;case"smpteOffset":t.writeUInt8(255),t.writeUInt8(84),t.writeVarInt(5);var u=31&e.hour|{24:0,25:32,29:64,30:96}[e.frameRate];t.writeUInt8(u),t.writeUInt8(e.min),t.writeUInt8(e.sec),t.writeUInt8(e.frame),t.writeUInt8(e.subFrame);break;case"timeSignature":t.writeUInt8(255),t.writeUInt8(88),t.writeVarInt(4),t.writeUInt8(e.numerator);u=255&Math.floor(Math.log(e.denominator)/Math.LN2);t.writeUInt8(u),t.writeUInt8(e.metronome),t.writeUInt8(e.thirtyseconds||8);break;case"keySignature":t.writeUInt8(255),t.writeUInt8(89),t.writeVarInt(2),t.writeInt8(e.key),t.writeUInt8(e.scale);break;case"sequencerSpecific":t.writeUInt8(255),t.writeUInt8(127),t.writeVarInt(s.length),t.writeBytes(s);break;case"unknownMeta":null!=e.metatypeByte&&(t.writeUInt8(255),t.writeUInt8(e.metatypeByte),t.writeVarInt(s.length),t.writeBytes(s));break;case"sysEx":t.writeUInt8(240),t.writeVarInt(s.length),t.writeBytes(s);break;case"endSysEx":t.writeUInt8(247),t.writeVarInt(s.length),t.writeBytes(s);break;case"noteOff":(c=(!1!==n&&e.byte9||n&&0==e.velocity?144:128)|e.channel)!==r&&t.writeUInt8(c),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteOn":(c=144|e.channel)!==r&&t.writeUInt8(c),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteAftertouch":(c=160|e.channel)!==r&&t.writeUInt8(c),t.writeUInt8(e.noteNumber),t.writeUInt8(e.amount);break;case"controller":(c=176|e.channel)!==r&&t.writeUInt8(c),t.writeUInt8(e.controllerType),t.writeUInt8(e.value);break;case"programChange":(c=192|e.channel)!==r&&t.writeUInt8(c),t.writeUInt8(e.programNumber);break;case"channelAftertouch":(c=208|e.channel)!==r&&t.writeUInt8(c),t.writeUInt8(e.amount);break;case"pitchBend":(c=224|e.channel)!==r&&t.writeUInt8(c);var u=8192+e.value,h=127&u,u=u>>7&127;t.writeUInt8(h),t.writeUInt8(u);break;default:throw"Unrecognized event type: "+i}return c})(n,e[o],a,r.useByte9ForNoteOff);t.writeChunk("MTrk",n.buffer)}function p(){this.buffer=[]}p.prototype.writeInt8=p.prototype.writeUInt8=function(t){this.buffer.push(255&t)},p.prototype.writeInt16=p.prototype.writeUInt16=function(t){var e=255&t;this.writeUInt8(t>>8&255),this.writeUInt8(e)},p.prototype.writeInt24=p.prototype.writeUInt24=function(t){var e=t>>8&255,r=255&t;this.writeUInt8(t>>16&255),this.writeUInt8(e),this.writeUInt8(r)},p.prototype.writeInt32=p.prototype.writeUInt32=function(t){var e=t>>16&255,r=t>>8&255,n=255&t;this.writeUInt8(t>>24&255),this.writeUInt8(e),this.writeUInt8(r),this.writeUInt8(n)},p.prototype.writeBytes=function(t){this.buffer=this.buffer.concat(Array.prototype.slice.call(t,0))},p.prototype.writeString=function(t){for(var e=t.length,r=[],n=0;n<e;n++)r.push(t.codePointAt(n));this.writeBytes(r)},p.prototype.writeVarInt=function(t){if(t<0)throw"Cannot write negative variable-length integer";if(t<=127)this.writeUInt8(t);else{var e=t,r=[];for(r.push(127&e),e>>=7;e;)r.push(127&e|128),e>>=7;this.writeBytes(r.reverse())}},p.prototype.writeChunk=function(t,e){this.writeString(t),this.writeUInt32(e.length),this.writeBytes(e)},t.exports=function(t,e){if("object"!=typeof t)throw"Invalid MIDI data";e=e||{};var r,n,i,a,o=t.header||{},s=t.tracks||[],c=s.length,u=new p;for(t=u,n=c,i=null==o.format?1:o.format,a=128,o.timeDivision?a=o.timeDivision:o.ticksPerFrame&&o.framesPerSecond?a=-(255&o.framesPerSecond)<<8|255&o.ticksPerFrame:o.ticksPerBeat&&(a=32767&o.ticksPerBeat),(o=new p).writeUInt16(i),o.writeUInt16(n),o.writeUInt16(a),t.writeChunk("MThd",o.buffer),r=0;r<c;r++)h(u,s[r],e);return u.buffer}},805:(t,e)=>{function n(t,e,r){void 0===r&&(r="ticks");var n=0,i=t.length,a=i;if(0<i&&t[i-1][r]<=e)return i-1;for(;n<a;){var o=Math.floor(n+(a-n)/2),s=t[o],c=t[o+1];if(s[r]===e){for(var u=o;u<t.length;u++)t[u][r]===e&&(o=u);return o}if(s[r]<e&&c[r]>e)return o;e<s[r]?a=o:s[r]<e&&(n=o+1)}return-1}Object.defineProperty(e,"__esModule",{value:!0}),e.insert=e.search=void 0,e.search=n,e.insert=function(t,e,r){void 0===r&&(r="ticks"),t.length?(r=n(t,e[r],r),t.splice(r+1,0,e)):t.push(e)}},543:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ControlChange=r.controlChangeIds=r.controlChangeNames=void 0,r.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},r.controlChangeIds=Object.keys(r.controlChangeNames).reduce(function(t,e){return t[r.controlChangeNames[e]]=e,t},{});var n=new WeakMap,i=new WeakMap;function e(t,e){n.set(this,e),i.set(this,t.controllerType),this.ticks=t.absoluteTime,this.value=t.value}Object.defineProperty(e.prototype,"number",{get:function(){return i.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return r.controlChangeNames[this.number]||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){return n.get(this).ticksToSeconds(this.ticks)},set:function(t){var e=n.get(this);this.ticks=e.secondsToTicks(t)},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},r.ControlChange=e},906:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createControlChanges=void 0;var n=r(543);e.createControlChanges=function(){return new Proxy({},{get:function(t,e){return t[e]||(n.controlChangeIds.hasOwnProperty(e)?t[n.controlChangeIds[e]]:void 0)},set:function(t,e,r){return n.controlChangeIds.hasOwnProperty(e)?t[n.controlChangeIds[e]]=r:t[e]=r,!0}})}},54:function(t,e,r){var a=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,i=0,a=e.length;i<a;i++)!n&&i in e||((n=n||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))},n=(Object.defineProperty(e,"__esModule",{value:!0}),e.encode=void 0,r(289)),i=r(535),o=r(507);e.encode=function(t){t={header:{format:1,numTracks:t.tracks.length+1,ticksPerBeat:t.header.ppq},tracks:a([a(a(a(a([{absoluteTime:0,deltaTime:0,meta:!0,text:t.header.name,type:"trackName"}],t.header.keySignatures.map(function(t){return t=t,e=i.keySignatureKeys.indexOf(t.key),{absoluteTime:t.ticks,deltaTime:0,key:e+7,meta:!0,scale:"major"===t.scale?0:1,type:"keySignature"};var e}),!0),t.header.meta.map(function(t){return{absoluteTime:t.ticks,deltaTime:0,meta:!0,text:t.text,type:t.type}}),!0),t.header.tempos.map(function(t){return{absoluteTime:t.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/t.bpm),type:"setTempo"}}),!0),t.header.timeSignatures.map(function(t){return{absoluteTime:t.ticks,deltaTime:0,denominator:t.timeSignature[1],meta:!0,metronome:24,numerator:t.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}),!0)],t.tracks.map(function(t){return a(a(a([{absoluteTime:0,deltaTime:0,meta:!0,text:t.name,type:"trackName"},{absoluteTime:0,channel:t.channel,deltaTime:0,programNumber:t.instrument.number,type:"programChange"}],(i=t,(0,o.flatten)(i.notes.map(function(t){return t=t,e=i.channel,[{absoluteTime:t.ticks,channel:e,deltaTime:0,noteNumber:t.midi,type:"noteOn",velocity:Math.floor(127*t.velocity)},{absoluteTime:t.ticks+t.durationTicks,channel:e,deltaTime:0,noteNumber:t.midi,type:"noteOff",velocity:Math.floor(127*t.noteOffVelocity)}];var e}))),!0),(r=>{for(var n=[],t=0;t<127;t++)r.controlChanges.hasOwnProperty(t)&&r.controlChanges[t].forEach(function(t){var e;n.push((e=r.channel,{absoluteTime:t.ticks,channel:e,controllerType:t.number,deltaTime:0,type:"controller",value:Math.floor(127*t.value)}))});return n})(t),!0),(n=[],(r=t).pitchBends.forEach(function(t){var e;n.push((e=r.channel,{absoluteTime:t.ticks,channel:e,deltaTime:0,type:"pitchBend",value:t.value}))}),n),!0);var r,n,i}),!0)};return t.tracks=t.tracks.map(function(t){t=t.sort(function(t,e){return t.absoluteTime-e.absoluteTime});var e=0;return t.forEach(function(t){t.deltaTime=t.absoluteTime-e,e=t.absoluteTime,delete t.absoluteTime}),t.push({deltaTime:0,meta:!0,type:"endOfTrack"}),t}),new Uint8Array((0,n.writeMidi)(t))}},535:(t,n,e)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Header=n.keySignatureKeys=void 0;var i=e(805),a=new WeakMap,e=(n.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"],r.prototype.update=function(){var n=this,i=0,a=0;this.tempos.sort(function(t,e){return t.ticks-e.ticks}),this.tempos.forEach(function(t,e){var e=(0<e?n.tempos[e-1]:n.tempos[0]).bpm,r=t.ticks/n.ppq-a;t.time=60/e*r+i,i=t.time,a+=r}),this.timeSignatures.sort(function(t,e){return t.ticks-e.ticks}),this.timeSignatures.forEach(function(t,e){var e=0<e?n.timeSignatures[e-1]:n.timeSignatures[0],r=(t.ticks-e.ticks)/n.ppq/e.timeSignature[0]/(e.timeSignature[1]/4);e.measures=e.measures||0,t.measures=r+e.measures})},r.prototype.ticksToSeconds=function(t){var e,r,n=(0,i.search)(this.tempos,t);return-1!==n?(e=(n=this.tempos[n]).time,r=(t-n.ticks)/this.ppq,e+60/n.bpm*r):t/this.ppq*.5},r.prototype.ticksToMeasures=function(t){var e,r=(0,i.search)(this.timeSignatures,t);return-1!==r?(e=(t-(r=this.timeSignatures[r]).ticks)/this.ppq,r.measures+e/(r.timeSignature[0]/r.timeSignature[1])/4):t/this.ppq/4},Object.defineProperty(r.prototype,"ppq",{get:function(){return a.get(this)},enumerable:!1,configurable:!0}),r.prototype.secondsToTicks=function(t){var e,r=(0,i.search)(this.tempos,t,"time");return-1!==r?(e=(t-(r=this.tempos[r]).time)/(60/r.bpm),Math.round(r.ticks+e*this.ppq)):Math.round(t/.5*this.ppq)},r.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(t){return{bpm:t.bpm,ticks:t.ticks}}),timeSignatures:this.timeSignatures}},r.prototype.fromJSON=function(t){this.name=t.name,this.tempos=t.tempos.map(function(t){return Object.assign({},t)}),this.timeSignatures=t.timeSignatures.map(function(t){return Object.assign({},t)}),this.keySignatures=t.keySignatures.map(function(t){return Object.assign({},t)}),this.meta=t.meta.map(function(t){return Object.assign({},t)}),a.set(this,t.ppq),this.update()},r.prototype.setTempo=function(t){this.tempos=[{bpm:t,ticks:0}],this.update()},r);function r(t){var e,r=this;this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",a.set(this,480),t&&(a.set(this,t.header.ticksPerBeat),t.tracks.forEach(function(t){t.forEach(function(t){t.meta&&("timeSignature"===t.type?r.timeSignatures.push({ticks:t.absoluteTime,timeSignature:[t.numerator,t.denominator]}):"setTempo"===t.type?r.tempos.push({bpm:6e7/t.microsecondsPerBeat,ticks:t.absoluteTime}):"keySignature"===t.type&&r.keySignatures.push({key:n.keySignatureKeys[t.key+7],scale:0===t.scale?"major":"minor",ticks:t.absoluteTime}))})}),e=0,t.tracks[0].forEach(function(t){e+=t.deltaTime,t.meta&&("trackName"===t.type?r.name=t.text:"text"!==t.type&&"cuePoint"!==t.type&&"marker"!==t.type&&"lyrics"!==t.type||r.meta.push({text:t.text,ticks:e,type:t.type}))}),this.update())}n.Header=e},362:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Instrument=void 0;var n=r(438),i=new WeakMap,r=(Object.defineProperty(a.prototype,"name",{get:function(){return(this.percussion?n.DrumKitByPatchID:n.instrumentByPatchID)[this.number]},set:function(t){t=n.instrumentByPatchID.indexOf(t);-1!==t&&(this.number=t)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"family",{get:function(){return this.percussion?"drums":n.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"percussion",{get:function(){return 9===i.get(this).channel},enumerable:!1,configurable:!0}),a.prototype.toJSON=function(){return{family:this.family,number:this.number,name:this.name}},a.prototype.fromJSON=function(t){this.number=t.number},a);function a(t,e){this.number=0,i.set(this,e),this.number=0,t&&(e=t.find(function(t){return"programChange"===t.type}))&&(this.number=e.programNumber)}e.Instrument=r},438:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DrumKitByPatchID=e.InstrumentFamilyByID=e.instrumentByPatchID=void 0,e.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],e.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],e.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}},233:function(t,e,r){var n=this&&this.__awaiter||function(t,o,s,c){return new(s=s||Promise)(function(r,e){function n(t){try{a(c.next(t))}catch(t){e(t)}}function i(t){try{a(c.throw(t))}catch(t){e(t)}}function a(t){var e;t.done?r(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(n,i)}a((c=c.apply(t,o||[])).next())})},i=this&&this.__generator||function(n,i){var a,o,s,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(r){return function(t){var e=[r,t];if(a)throw new TypeError("Generator is already executing.");for(;c;)try{if(a=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,o=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!((s=0<(s=c.trys).length&&s[s.length-1])||6!==e[0]&&2!==e[0])){c=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3]))c.label=e[1];else if(6===e[0]&&c.label<s[1])c.label=s[1],s=e;else{if(!(s&&c.label<s[2])){s[2]&&c.ops.pop(),c.trys.pop();continue}c.label=s[2],c.ops.push(e)}}e=i.call(n,c)}catch(t){e=[6,t],o=0}finally{a=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}},a=(Object.defineProperty(e,"__esModule",{value:!0}),e.Header=e.Track=e.Midi=void 0,r(289)),o=r(535),s=r(334),c=r(54);function u(t){var e,r=this,n=null;t&&(e=t instanceof ArrayBuffer?new Uint8Array(t):t,(n=(0,a.parseMidi)(e)).tracks.forEach(function(t){var e=0;t.forEach(function(t){e+=t.deltaTime,t.absoluteTime=e})}),n.tracks=(t=>{for(var e=[],r=0;r<t.length;r++)for(var n=e.length,i=new Map,a=Array(16).fill(0),o=0,s=t[r];o<s.length;o++){var c,u=s[o],h=n,p=u.channel;void 0!==p&&("programChange"===u.type&&(a[p]=u.programNumber),c=a[p],c="".concat(c," ").concat(p),i.has(c)?h=i.get(c):(h=n+i.size,i.set(c,h))),e[h]||e.push([]),e[h].push(u)}return e})(n.tracks)),this.header=new o.Header(n),this.tracks=[],t&&(this.tracks=n.tracks.map(function(t){return new s.Track(t,r.header)}),1===n.header.format)&&0===this.tracks[0].duration&&this.tracks.shift()}u.fromUrl=function(r){return n(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return[4,fetch(r)];case 1:return(e=t.sent()).ok?[4,e.arrayBuffer()]:[3,3];case 2:return[2,new u(t.sent())];case 3:throw new Error("Could not load '".concat(r,"'"))}})})},Object.defineProperty(u.prototype,"name",{get:function(){return this.header.name},set:function(t){this.header.name=t},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"duration",{get:function(){var t=this.tracks.map(function(t){return t.duration});return Math.max.apply(Math,t)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"durationTicks",{get:function(){var t=this.tracks.map(function(t){return t.durationTicks});return Math.max.apply(Math,t)},enumerable:!1,configurable:!0}),u.prototype.addTrack=function(){var t=new s.Track(void 0,this.header);return this.tracks.push(t),t},u.prototype.toArray=function(){return(0,c.encode)(this)},u.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(t){return t.toJSON()})}},u.prototype.fromJSON=function(t){var r=this;this.header=new o.Header,this.header.fromJSON(t.header),this.tracks=t.tracks.map(function(t){var e=new s.Track(void 0,r.header);return e.fromJSON(t),e})},u.prototype.clone=function(){var t=new u;return t.fromJSON(this.toJSON()),t},e.Midi=u;var h=r(334),p=(Object.defineProperty(e,"Track",{enumerable:!0,get:function(){return h.Track}}),r(535));Object.defineProperty(e,"Header",{enumerable:!0,get:function(){return p.Header}})},518:(t,e)=>{function r(t){return["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][t%12]}Object.defineProperty(e,"__esModule",{value:!0}),e.Note=void 0;n=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,i={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};var n,i,a=new WeakMap,o=(Object.defineProperty(s.prototype,"name",{get:function(){return t=this.midi,e=Math.floor(t/12)-1,r(t)+e.toString();var t,e},set:function(t){var e;this.midi=(t=t,t=n.exec(t),e=t[1],t=t[2],i[e.toLowerCase()]+12*(parseInt(t,10)+1))},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(t){t-=this.octave;this.midi+=12*t},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"pitch",{get:function(){return r(this.midi)},set:function(t){this.midi=12*(this.octave+1)+["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"].indexOf(t)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"duration",{get:function(){var t=a.get(this);return t.ticksToSeconds(this.ticks+this.durationTicks)-t.ticksToSeconds(this.ticks)},set:function(t){t=a.get(this).secondsToTicks(this.time+t);this.durationTicks=t-this.ticks},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"time",{get:function(){return a.get(this).ticksToSeconds(this.ticks)},set:function(t){var e=a.get(this);this.ticks=e.secondsToTicks(t)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"bars",{get:function(){return a.get(this).ticksToMeasures(this.ticks)},enumerable:!1,configurable:!0}),s.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},s);function s(t,e,r){a.set(this,r),this.midi=t.midi,this.velocity=t.velocity,this.noteOffVelocity=e.velocity,this.ticks=t.ticks,this.durationTicks=e.ticks-t.ticks}e.Note=o},882:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PitchBend=void 0;var r=new WeakMap;function n(t,e){r.set(this,e),this.ticks=t.absoluteTime,this.value=t.value}Object.defineProperty(n.prototype,"time",{get:function(){return r.get(this).ticksToSeconds(this.ticks)},set:function(t){var e=r.get(this);this.ticks=e.secondsToTicks(t)},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},e.PitchBend=n},334:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Track=void 0;var n=r(805),i=r(543),o=r(906),a=r(882),s=r(362),c=r(518),u=new WeakMap;function h(t,e){var r=this;if(this.name="",this.notes=[],this.controlChanges=(0,o.createControlChanges)(),this.pitchBends=[],u.set(this,e),t&&(e=t.find(function(t){return"trackName"===t.type}),this.name=e?e.text:""),this.instrument=new s.Instrument(t,this),this.channel=0,t){for(var n=t.filter(function(t){return"noteOn"===t.type}),i=t.filter(function(t){return"noteOff"===t.type}),a=this;n.length;)(()=>{var e=n.shift(),t=(a.channel=e.channel,i.findIndex(function(t){return t.noteNumber===e.noteNumber&&t.absoluteTime>=e.absoluteTime}));-1!==t&&(t=i.splice(t,1)[0],a.addNote({durationTicks:t.absoluteTime-e.absoluteTime,midi:e.noteNumber,noteOffVelocity:t.velocity/127,ticks:e.absoluteTime,velocity:e.velocity/127}))})();t.filter(function(t){return"controller"===t.type}).forEach(function(t){r.addCC({number:t.controllerType,ticks:t.absoluteTime,value:t.value/127})}),t.filter(function(t){return"pitchBend"===t.type}).forEach(function(t){r.addPitchBend({ticks:t.absoluteTime,value:t.value/Math.pow(2,13)})});e=t.find(function(t){return"endOfTrack"===t.type});this.endOfTrackTicks=void 0!==e?e.absoluteTime:void 0}}h.prototype.addNote=function(t){var e=u.get(this),e=new c.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},e);return Object.assign(e,t),(0,n.insert)(this.notes,e,"ticks"),this},h.prototype.addCC=function(t){var e=u.get(this),e=new i.ControlChange({controllerType:t.number},e);return delete t.number,Object.assign(e,t),Array.isArray(this.controlChanges[e.number])||(this.controlChanges[e.number]=[]),(0,n.insert)(this.controlChanges[e.number],e,"ticks"),this},h.prototype.addPitchBend=function(t){var e=u.get(this),e=new a.PitchBend({},e);return Object.assign(e,t),(0,n.insert)(this.pitchBends,e,"ticks"),this},Object.defineProperty(h.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var t=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,e=0;e<this.notes.length-1;e++){var r=this.notes[e].time+this.notes[e].duration;t<r&&(t=r)}return t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var t=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,e=0;e<this.notes.length-1;e++){var r=this.notes[e].ticks+this.notes[e].durationTicks;t<r&&(t=r)}return t},enumerable:!1,configurable:!0}),h.prototype.fromJSON=function(t){var e,r=this;for(e in this.name=t.name,this.channel=t.channel,this.instrument=new s.Instrument(void 0,this),this.instrument.fromJSON(t.instrument),void 0!==t.endOfTrackTicks&&(this.endOfTrackTicks=t.endOfTrackTicks),t.controlChanges)t.controlChanges[e]&&t.controlChanges[e].forEach(function(t){r.addCC({number:t.number,ticks:t.ticks,value:t.value})});t.notes.forEach(function(t){r.addNote({durationTicks:t.durationTicks,midi:t.midi,ticks:t.ticks,velocity:t.velocity})})},h.prototype.toJSON=function(){for(var t={},e=0;e<127;e++)this.controlChanges.hasOwnProperty(e)&&(t[e]=this.controlChanges[e].map(function(t){return t.toJSON()}));var r={channel:this.channel,controlChanges:t,pitchBends:this.pitchBends.map(function(t){return t.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(t){return t.toJSON()})};return void 0!==this.endOfTrackTicks&&(r.endOfTrackTicks=this.endOfTrackTicks),r},e.Track=h}},i={},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(233);function n(t){var e=i[t];return void 0!==e||(e=i[t]={exports:{}},r[t].call(e.exports,e,e.exports,n)),e.exports}var r,i});